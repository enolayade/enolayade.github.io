var Ut=Object.defineProperty;var Pt=(e,t,s)=>t in e?Ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var a=(e,t,s)=>(Pt(e,typeof t!="symbol"?t+"":t,s),s);const Ht=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}};Ht();/*!
  * pinia v2.0.14
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let lt;const we=e=>lt=e,ct=Symbol();function Ne(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var de;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(de||(de={}));function Gt(){const e=VueDemi.effectScope(!0),t=e.run(()=>VueDemi.ref({}));let s=[],n=[];const i=VueDemi.markRaw({install(o){we(i),VueDemi.isVue2||(i._a=o,o.provide(ct,i),o.config.globalProperties.$pinia=i,n.forEach(r=>s.push(r)),n=[])},use(o){return!this._a&&!VueDemi.isVue2?n.push(o):s.push(o),this},_p:s,_a:null,_e:e,_s:new Map,state:t});return i}const dt=()=>{};function qe(e,t,s,n=dt){e.push(t);const i=()=>{const o=e.indexOf(t);o>-1&&(e.splice(o,1),n())};return!s&&VueDemi.getCurrentInstance()&&VueDemi.onUnmounted(i),i}function ee(e,...t){e.slice().forEach(s=>{s(...t)})}function Oe(e,t){for(const s in t){if(!t.hasOwnProperty(s))continue;const n=t[s],i=e[s];Ne(i)&&Ne(n)&&e.hasOwnProperty(s)&&!VueDemi.isRef(n)&&!VueDemi.isReactive(n)?e[s]=Oe(i,n):e[s]=n}return e}const jt=Symbol(),zt=new WeakMap;function qt(e){return VueDemi.isVue2?!zt.has(e):!Ne(e)||!e.hasOwnProperty(jt)}const{assign:q}=Object;function Jt(e){return!!(VueDemi.isRef(e)&&e.effect)}function Wt(e,t,s,n){const{state:i,actions:o,getters:r}=t,u=s.state.value[e];let l;function w(){u||(VueDemi.isVue2?VueDemi.set(s.state.value,e,i?i():{}):s.state.value[e]=i?i():{});const h=VueDemi.toRefs(s.state.value[e]);return q(h,o,Object.keys(r||{}).reduce((C,S)=>(C[S]=VueDemi.markRaw(VueDemi.computed(()=>{we(s);const V=s._s.get(e);if(!(VueDemi.isVue2&&!V._r))return r[S].call(V,V)})),C),{}))}return l=ht(e,w,t,s,n,!0),l.$reset=function(){const C=i?i():{};this.$patch(S=>{q(S,C)})},l}function ht(e,t,s={},n,i,o){let r;const u=q({actions:{}},s),l={deep:!0};let w,h,C=VueDemi.markRaw([]),S=VueDemi.markRaw([]),V;const O=n.state.value[e];!o&&!O&&(VueDemi.isVue2?VueDemi.set(n.state.value,e,{}):n.state.value[e]={}),VueDemi.ref({});let U;function P(d){let E;w=h=!1,typeof d=="function"?(d(n.state.value[e]),E={type:de.patchFunction,storeId:e,events:V}):(Oe(n.state.value[e],d),E={type:de.patchObject,payload:d,storeId:e,events:V});const F=U=Symbol();VueDemi.nextTick().then(()=>{U===F&&(w=!0)}),h=!0,ee(C,E,n.state.value[e])}const B=dt;function b(){r.stop(),C=[],S=[],n._s.delete(e)}function H(d,E){return function(){we(n);const F=Array.from(arguments),k=[],y=[];function f(m){k.push(m)}function g(m){y.push(m)}ee(S,{args:F,name:d,store:c,after:f,onError:g});let p;try{p=E.apply(this&&this.$id===e?this:c,F)}catch(m){throw ee(y,m),m}return p instanceof Promise?p.then(m=>(ee(k,m),m)).catch(m=>(ee(y,m),Promise.reject(m))):(ee(k,p),p)}}const Q={_p:n,$id:e,$onAction:qe.bind(null,S),$patch:P,$reset:B,$subscribe(d,E={}){const F=qe(C,d,E.detached,()=>k()),k=r.run(()=>VueDemi.watch(()=>n.state.value[e],y=>{(E.flush==="sync"?h:w)&&d({storeId:e,type:de.direct,events:V},y)},q({},l,E)));return F},$dispose:b};VueDemi.isVue2&&(Q._r=!1);const c=VueDemi.reactive(q({},Q));n._s.set(e,c);const v=n._e.run(()=>(r=VueDemi.effectScope(),r.run(()=>t())));for(const d in v){const E=v[d];if(VueDemi.isRef(E)&&!Jt(E)||VueDemi.isReactive(E))o||(O&&qt(E)&&(VueDemi.isRef(E)?E.value=O[d]:Oe(E,O[d])),VueDemi.isVue2?VueDemi.set(n.state.value[e],d,E):n.state.value[e][d]=E);else if(typeof E=="function"){const F=H(d,E);VueDemi.isVue2?VueDemi.set(v,d,F):v[d]=F,u.actions[d]=E}}return VueDemi.isVue2?Object.keys(v).forEach(d=>{VueDemi.set(c,d,v[d])}):(q(c,v),q(VueDemi.toRaw(c),v)),Object.defineProperty(c,"$state",{get:()=>n.state.value[e],set:d=>{P(E=>{q(E,d)})}}),VueDemi.isVue2&&(c._r=!0),n._p.forEach(d=>{q(c,r.run(()=>d({store:c,app:n._a,pinia:n,options:u})))}),O&&o&&s.hydrate&&s.hydrate(c.$state,O),w=!0,h=!0,c}function Xt(e,t,s){let n,i;const o=typeof t=="function";typeof e=="string"?(n=e,i=o?s:t):(i=e,n=e.id);function r(u,l){const w=VueDemi.getCurrentInstance();return u=u||w&&VueDemi.inject(ct),u&&we(u),u=lt,u._s.has(n)||(o?ht(n,t,i,u):Wt(n,i,u)),u._s.get(n)}return r.$id=n,r}var Yt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},mt={exports:{}};(function(e){(function(t){function s(c,v){var d=(c&65535)+(v&65535),E=(c>>16)+(v>>16)+(d>>16);return E<<16|d&65535}function n(c,v){return c<<v|c>>>32-v}function i(c,v,d,E,F,k){return s(n(s(s(v,c),s(E,k)),F),d)}function o(c,v,d,E,F,k,y){return i(v&d|~v&E,c,v,F,k,y)}function r(c,v,d,E,F,k,y){return i(v&E|d&~E,c,v,F,k,y)}function u(c,v,d,E,F,k,y){return i(v^d^E,c,v,F,k,y)}function l(c,v,d,E,F,k,y){return i(d^(v|~E),c,v,F,k,y)}function w(c,v){c[v>>5]|=128<<v%32,c[(v+64>>>9<<4)+14]=v;var d,E,F,k,y,f=1732584193,g=-271733879,p=-1732584194,m=271733878;for(d=0;d<c.length;d+=16)E=f,F=g,k=p,y=m,f=o(f,g,p,m,c[d],7,-680876936),m=o(m,f,g,p,c[d+1],12,-389564586),p=o(p,m,f,g,c[d+2],17,606105819),g=o(g,p,m,f,c[d+3],22,-1044525330),f=o(f,g,p,m,c[d+4],7,-176418897),m=o(m,f,g,p,c[d+5],12,1200080426),p=o(p,m,f,g,c[d+6],17,-1473231341),g=o(g,p,m,f,c[d+7],22,-45705983),f=o(f,g,p,m,c[d+8],7,1770035416),m=o(m,f,g,p,c[d+9],12,-1958414417),p=o(p,m,f,g,c[d+10],17,-42063),g=o(g,p,m,f,c[d+11],22,-1990404162),f=o(f,g,p,m,c[d+12],7,1804603682),m=o(m,f,g,p,c[d+13],12,-40341101),p=o(p,m,f,g,c[d+14],17,-1502002290),g=o(g,p,m,f,c[d+15],22,1236535329),f=r(f,g,p,m,c[d+1],5,-165796510),m=r(m,f,g,p,c[d+6],9,-1069501632),p=r(p,m,f,g,c[d+11],14,643717713),g=r(g,p,m,f,c[d],20,-373897302),f=r(f,g,p,m,c[d+5],5,-701558691),m=r(m,f,g,p,c[d+10],9,38016083),p=r(p,m,f,g,c[d+15],14,-660478335),g=r(g,p,m,f,c[d+4],20,-405537848),f=r(f,g,p,m,c[d+9],5,568446438),m=r(m,f,g,p,c[d+14],9,-1019803690),p=r(p,m,f,g,c[d+3],14,-187363961),g=r(g,p,m,f,c[d+8],20,1163531501),f=r(f,g,p,m,c[d+13],5,-1444681467),m=r(m,f,g,p,c[d+2],9,-51403784),p=r(p,m,f,g,c[d+7],14,1735328473),g=r(g,p,m,f,c[d+12],20,-1926607734),f=u(f,g,p,m,c[d+5],4,-378558),m=u(m,f,g,p,c[d+8],11,-2022574463),p=u(p,m,f,g,c[d+11],16,1839030562),g=u(g,p,m,f,c[d+14],23,-35309556),f=u(f,g,p,m,c[d+1],4,-1530992060),m=u(m,f,g,p,c[d+4],11,1272893353),p=u(p,m,f,g,c[d+7],16,-155497632),g=u(g,p,m,f,c[d+10],23,-1094730640),f=u(f,g,p,m,c[d+13],4,681279174),m=u(m,f,g,p,c[d],11,-358537222),p=u(p,m,f,g,c[d+3],16,-722521979),g=u(g,p,m,f,c[d+6],23,76029189),f=u(f,g,p,m,c[d+9],4,-640364487),m=u(m,f,g,p,c[d+12],11,-421815835),p=u(p,m,f,g,c[d+15],16,530742520),g=u(g,p,m,f,c[d+2],23,-995338651),f=l(f,g,p,m,c[d],6,-198630844),m=l(m,f,g,p,c[d+7],10,1126891415),p=l(p,m,f,g,c[d+14],15,-1416354905),g=l(g,p,m,f,c[d+5],21,-57434055),f=l(f,g,p,m,c[d+12],6,1700485571),m=l(m,f,g,p,c[d+3],10,-1894986606),p=l(p,m,f,g,c[d+10],15,-1051523),g=l(g,p,m,f,c[d+1],21,-2054922799),f=l(f,g,p,m,c[d+8],6,1873313359),m=l(m,f,g,p,c[d+15],10,-30611744),p=l(p,m,f,g,c[d+6],15,-1560198380),g=l(g,p,m,f,c[d+13],21,1309151649),f=l(f,g,p,m,c[d+4],6,-145523070),m=l(m,f,g,p,c[d+11],10,-1120210379),p=l(p,m,f,g,c[d+2],15,718787259),g=l(g,p,m,f,c[d+9],21,-343485551),f=s(f,E),g=s(g,F),p=s(p,k),m=s(m,y);return[f,g,p,m]}function h(c){var v,d="",E=c.length*32;for(v=0;v<E;v+=8)d+=String.fromCharCode(c[v>>5]>>>v%32&255);return d}function C(c){var v,d=[];for(d[(c.length>>2)-1]=void 0,v=0;v<d.length;v+=1)d[v]=0;var E=c.length*8;for(v=0;v<E;v+=8)d[v>>5]|=(c.charCodeAt(v/8)&255)<<v%32;return d}function S(c){return h(w(C(c),c.length*8))}function V(c,v){var d,E=C(c),F=[],k=[],y;for(F[15]=k[15]=void 0,E.length>16&&(E=w(E,c.length*8)),d=0;d<16;d+=1)F[d]=E[d]^909522486,k[d]=E[d]^1549556828;return y=w(F.concat(C(v)),512+v.length*8),h(w(k.concat(y),512+128))}function O(c){var v="0123456789abcdef",d="",E,F;for(F=0;F<c.length;F+=1)E=c.charCodeAt(F),d+=v.charAt(E>>>4&15)+v.charAt(E&15);return d}function U(c){return unescape(encodeURIComponent(c))}function P(c){return S(U(c))}function B(c){return O(P(c))}function b(c,v){return V(U(c),U(v))}function H(c,v){return O(b(c,v))}function Q(c,v,d){return v?d?b(v,c):H(v,c):d?P(c):B(c)}e.exports?e.exports=Q:t.md5=Q})(Yt)})(mt);var Zt=mt.exports,pt={exports:{}},ft=function(t,s){return function(){for(var i=new Array(arguments.length),o=0;o<i.length;o++)i[o]=arguments[o];return t.apply(s,i)}},Qt=ft,xe=Object.prototype.toString,Me=function(e){return function(t){var s=xe.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())}}(Object.create(null));function K(e){return e=e.toLowerCase(),function(s){return Me(s)===e}}function Ue(e){return Array.isArray(e)}function Ee(e){return typeof e=="undefined"}function Kt(e){return e!==null&&!Ee(e)&&e.constructor!==null&&!Ee(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var gt=K("ArrayBuffer");function es(e){var t;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&gt(e.buffer),t}function ts(e){return typeof e=="string"}function ss(e){return typeof e=="number"}function vt(e){return e!==null&&typeof e=="object"}function ge(e){if(Me(e)!=="object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}var ns=K("Date"),is=K("File"),os=K("Blob"),rs=K("FileList");function Pe(e){return xe.call(e)==="[object Function]"}function us(e){return vt(e)&&Pe(e.pipe)}function as(e){var t="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||xe.call(e)===t||Pe(e.toString)&&e.toString()===t)}var ls=K("URLSearchParams");function cs(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function ds(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function He(e,t){if(!(e===null||typeof e=="undefined"))if(typeof e!="object"&&(e=[e]),Ue(e))for(var s=0,n=e.length;s<n;s++)t.call(null,e[s],s,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function $e(){var e={};function t(i,o){ge(e[o])&&ge(i)?e[o]=$e(e[o],i):ge(i)?e[o]=$e({},i):Ue(i)?e[o]=i.slice():e[o]=i}for(var s=0,n=arguments.length;s<n;s++)He(arguments[s],t);return e}function hs(e,t,s){return He(t,function(i,o){s&&typeof i=="function"?e[o]=Qt(i,s):e[o]=i}),e}function ms(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}function ps(e,t,s,n){e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,s&&Object.assign(e.prototype,s)}function fs(e,t,s){var n,i,o,r={};t=t||{};do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)o=n[i],r[o]||(t[o]=e[o],r[o]=!0);e=Object.getPrototypeOf(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t}function gs(e,t,s){e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;var n=e.indexOf(t,s);return n!==-1&&n===s}function vs(e){if(!e)return null;var t=e.length;if(Ee(t))return null;for(var s=new Array(t);t-- >0;)s[t]=e[t];return s}var _s=function(e){return function(t){return e&&t instanceof e}}(typeof Uint8Array!="undefined"&&Object.getPrototypeOf(Uint8Array)),T={isArray:Ue,isArrayBuffer:gt,isBuffer:Kt,isFormData:as,isArrayBufferView:es,isString:ts,isNumber:ss,isObject:vt,isPlainObject:ge,isUndefined:Ee,isDate:ns,isFile:is,isBlob:os,isFunction:Pe,isStream:us,isURLSearchParams:ls,isStandardBrowserEnv:ds,forEach:He,merge:$e,extend:hs,trim:cs,stripBOM:ms,inherits:ps,toFlatObject:fs,kindOf:Me,kindOfTest:K,endsWith:gs,toArray:vs,isTypedArray:_s,isFileList:rs},te=T;function Je(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var _t=function(t,s,n){if(!s)return t;var i;if(n)i=n(s);else if(te.isURLSearchParams(s))i=s.toString();else{var o=[];te.forEach(s,function(l,w){l===null||typeof l=="undefined"||(te.isArray(l)?w=w+"[]":l=[l],te.forEach(l,function(C){te.isDate(C)?C=C.toISOString():te.isObject(C)&&(C=JSON.stringify(C)),o.push(Je(w)+"="+Je(C))}))}),i=o.join("&")}if(i){var r=t.indexOf("#");r!==-1&&(t=t.slice(0,r)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t},Es=T;function Ce(){this.handlers=[]}Ce.prototype.use=function(t,s,n){return this.handlers.push({fulfilled:t,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};Ce.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};Ce.prototype.forEach=function(t){Es.forEach(this.handlers,function(n){n!==null&&t(n)})};var ws=Ce,Cs=T,Ds=function(t,s){Cs.forEach(t,function(i,o){o!==s&&o.toUpperCase()===s.toUpperCase()&&(t[s]=i,delete t[o])})},Et=T;function oe(e,t,s,n,i){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),n&&(this.request=n),i&&(this.response=i)}Et.inherits(oe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var wt=oe.prototype,Ct={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(e){Ct[e]={value:e}});Object.defineProperties(oe,Ct);Object.defineProperty(wt,"isAxiosError",{value:!0});oe.from=function(e,t,s,n,i,o){var r=Object.create(wt);return Et.toFlatObject(e,r,function(l){return l!==Error.prototype}),oe.call(r,e.message,t,s,n,i),r.name=e.name,o&&Object.assign(r,o),r};var ae=oe,Dt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},G=T;function Vs(e,t){t=t||new FormData;var s=[];function n(o){return o===null?"":G.isDate(o)?o.toISOString():G.isArrayBuffer(o)||G.isTypedArray(o)?typeof Blob=="function"?new Blob([o]):Buffer.from(o):o}function i(o,r){if(G.isPlainObject(o)||G.isArray(o)){if(s.indexOf(o)!==-1)throw Error("Circular reference detected in "+r);s.push(o),G.forEach(o,function(l,w){if(!G.isUndefined(l)){var h=r?r+"."+w:w,C;if(l&&!r&&typeof l=="object"){if(G.endsWith(w,"{}"))l=JSON.stringify(l);else if(G.endsWith(w,"[]")&&(C=G.toArray(l))){C.forEach(function(S){!G.isUndefined(S)&&t.append(h,n(S))});return}}i(l,h)}}),s.pop()}else t.append(r,n(o))}return i(e),t}var Vt=Vs,ke=ae,Fs=function(t,s,n){var i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):s(new ke("Request failed with status code "+n.status,[ke.ERR_BAD_REQUEST,ke.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))},pe=T,Ss=pe.isStandardBrowserEnv()?function(){return{write:function(s,n,i,o,r,u){var l=[];l.push(s+"="+encodeURIComponent(n)),pe.isNumber(i)&&l.push("expires="+new Date(i).toGMTString()),pe.isString(o)&&l.push("path="+o),pe.isString(r)&&l.push("domain="+r),u===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(s){var n=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),ks=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},ys=function(t,s){return s?t.replace(/\/+$/,"")+"/"+s.replace(/^\/+/,""):t},As=ks,Bs=ys,Ft=function(t,s){return t&&!As(s)?Bs(t,s):s},ye=T,Rs=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],Ts=function(t){var s={},n,i,o;return t&&ye.forEach(t.split(`
`),function(u){if(o=u.indexOf(":"),n=ye.trim(u.substr(0,o)).toLowerCase(),i=ye.trim(u.substr(o+1)),n){if(s[n]&&Rs.indexOf(n)>=0)return;n==="set-cookie"?s[n]=(s[n]?s[n]:[]).concat([i]):s[n]=s[n]?s[n]+", "+i:i}}),s},We=T,Ns=We.isStandardBrowserEnv()?function(){var t=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a"),n;function i(o){var r=o;return t&&(s.setAttribute("href",r),r=s.href),s.setAttribute("href",r),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return n=i(window.location.href),function(r){var u=We.isString(r)?i(r):r;return u.protocol===n.protocol&&u.host===n.host}}():function(){return function(){return!0}}(),Le=ae,Os=T;function St(e){Le.call(this,e==null?"canceled":e,Le.ERR_CANCELED),this.name="CanceledError"}Os.inherits(St,Le,{__CANCEL__:!0});var De=St,$s=function(t){var s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""},ce=T,Ls=Fs,bs=Ss,Is=_t,xs=Ft,Ms=Ts,Us=Ns,Ps=Dt,z=ae,Hs=De,Gs=$s,Xe=function(t){return new Promise(function(n,i){var o=t.data,r=t.headers,u=t.responseType,l;function w(){t.cancelToken&&t.cancelToken.unsubscribe(l),t.signal&&t.signal.removeEventListener("abort",l)}ce.isFormData(o)&&ce.isStandardBrowserEnv()&&delete r["Content-Type"];var h=new XMLHttpRequest;if(t.auth){var C=t.auth.username||"",S=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";r.Authorization="Basic "+btoa(C+":"+S)}var V=xs(t.baseURL,t.url);h.open(t.method.toUpperCase(),Is(V,t.params,t.paramsSerializer),!0),h.timeout=t.timeout;function O(){if(!!h){var B="getAllResponseHeaders"in h?Ms(h.getAllResponseHeaders()):null,b=!u||u==="text"||u==="json"?h.responseText:h.response,H={data:b,status:h.status,statusText:h.statusText,headers:B,config:t,request:h};Ls(function(c){n(c),w()},function(c){i(c),w()},H),h=null}}if("onloadend"in h?h.onloadend=O:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(O)},h.onabort=function(){!h||(i(new z("Request aborted",z.ECONNABORTED,t,h)),h=null)},h.onerror=function(){i(new z("Network Error",z.ERR_NETWORK,t,h,h)),h=null},h.ontimeout=function(){var b=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",H=t.transitional||Ps;t.timeoutErrorMessage&&(b=t.timeoutErrorMessage),i(new z(b,H.clarifyTimeoutError?z.ETIMEDOUT:z.ECONNABORTED,t,h)),h=null},ce.isStandardBrowserEnv()){var U=(t.withCredentials||Us(V))&&t.xsrfCookieName?bs.read(t.xsrfCookieName):void 0;U&&(r[t.xsrfHeaderName]=U)}"setRequestHeader"in h&&ce.forEach(r,function(b,H){typeof o=="undefined"&&H.toLowerCase()==="content-type"?delete r[H]:h.setRequestHeader(H,b)}),ce.isUndefined(t.withCredentials)||(h.withCredentials=!!t.withCredentials),u&&u!=="json"&&(h.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&h.addEventListener("progress",t.onDownloadProgress),typeof t.onUploadProgress=="function"&&h.upload&&h.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(l=function(B){!h||(i(!B||B&&B.type?new Hs:B),h.abort(),h=null)},t.cancelToken&&t.cancelToken.subscribe(l),t.signal&&(t.signal.aborted?l():t.signal.addEventListener("abort",l))),o||(o=null);var P=Gs(V);if(P&&["http","https","file"].indexOf(P)===-1){i(new z("Unsupported protocol "+P+":",z.ERR_BAD_REQUEST,t));return}h.send(o)})},js=null,A=T,Ye=Ds,Ze=ae,zs=Dt,qs=Vt,Js={"Content-Type":"application/x-www-form-urlencoded"};function Qe(e,t){!A.isUndefined(e)&&A.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function Ws(){var e;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(e=Xe),e}function Xs(e,t,s){if(A.isString(e))try{return(t||JSON.parse)(e),A.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(e)}var Ve={transitional:zs,adapter:Ws(),transformRequest:[function(t,s){if(Ye(s,"Accept"),Ye(s,"Content-Type"),A.isFormData(t)||A.isArrayBuffer(t)||A.isBuffer(t)||A.isStream(t)||A.isFile(t)||A.isBlob(t))return t;if(A.isArrayBufferView(t))return t.buffer;if(A.isURLSearchParams(t))return Qe(s,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var n=A.isObject(t),i=s&&s["Content-Type"],o;if((o=A.isFileList(t))||n&&i==="multipart/form-data"){var r=this.env&&this.env.FormData;return qs(o?{"files[]":t}:t,r&&new r)}else if(n||i==="application/json")return Qe(s,"application/json"),Xs(t);return t}],transformResponse:[function(t){var s=this.transitional||Ve.transitional,n=s&&s.silentJSONParsing,i=s&&s.forcedJSONParsing,o=!n&&this.responseType==="json";if(o||i&&A.isString(t)&&t.length)try{return JSON.parse(t)}catch(r){if(o)throw r.name==="SyntaxError"?Ze.from(r,Ze.ERR_BAD_RESPONSE,this,null,this.response):r}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:js},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};A.forEach(["delete","get","head"],function(t){Ve.headers[t]={}});A.forEach(["post","put","patch"],function(t){Ve.headers[t]=A.merge(Js)});var Ge=Ve,Ys=T,Zs=Ge,Qs=function(t,s,n){var i=this||Zs;return Ys.forEach(n,function(r){t=r.call(i,t,s)}),t},kt=function(t){return!!(t&&t.__CANCEL__)},Ke=T,Ae=Qs,Ks=kt,en=Ge,tn=De;function Be(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new tn}var sn=function(t){Be(t),t.headers=t.headers||{},t.data=Ae.call(t,t.data,t.headers,t.transformRequest),t.headers=Ke.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),Ke.forEach(["delete","get","head","post","put","patch","common"],function(i){delete t.headers[i]});var s=t.adapter||en.adapter;return s(t).then(function(i){return Be(t),i.data=Ae.call(t,i.data,i.headers,t.transformResponse),i},function(i){return Ks(i)||(Be(t),i&&i.response&&(i.response.data=Ae.call(t,i.response.data,i.response.headers,t.transformResponse))),Promise.reject(i)})},I=T,yt=function(t,s){s=s||{};var n={};function i(h,C){return I.isPlainObject(h)&&I.isPlainObject(C)?I.merge(h,C):I.isPlainObject(C)?I.merge({},C):I.isArray(C)?C.slice():C}function o(h){if(I.isUndefined(s[h])){if(!I.isUndefined(t[h]))return i(void 0,t[h])}else return i(t[h],s[h])}function r(h){if(!I.isUndefined(s[h]))return i(void 0,s[h])}function u(h){if(I.isUndefined(s[h])){if(!I.isUndefined(t[h]))return i(void 0,t[h])}else return i(void 0,s[h])}function l(h){if(h in s)return i(t[h],s[h]);if(h in t)return i(void 0,t[h])}var w={url:r,method:r,data:r,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,beforeRedirect:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:l};return I.forEach(Object.keys(t).concat(Object.keys(s)),function(C){var S=w[C]||o,V=S(C);I.isUndefined(V)&&S!==l||(n[C]=V)}),n},At={version:"0.27.2"},nn=At.version,Z=ae,je={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){je[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});var et={};je.transitional=function(t,s,n){function i(o,r){return"[Axios v"+nn+"] Transitional option '"+o+"'"+r+(n?". "+n:"")}return function(o,r,u){if(t===!1)throw new Z(i(r," has been removed"+(s?" in "+s:"")),Z.ERR_DEPRECATED);return s&&!et[r]&&(et[r]=!0,console.warn(i(r," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(o,r,u):!0}};function on(e,t,s){if(typeof e!="object")throw new Z("options must be an object",Z.ERR_BAD_OPTION_VALUE);for(var n=Object.keys(e),i=n.length;i-- >0;){var o=n[i],r=t[o];if(r){var u=e[o],l=u===void 0||r(u,o,e);if(l!==!0)throw new Z("option "+o+" must be "+l,Z.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new Z("Unknown option "+o,Z.ERR_BAD_OPTION)}}var rn={assertOptions:on,validators:je},Bt=T,un=_t,tt=ws,st=sn,Fe=yt,an=Ft,Rt=rn,se=Rt.validators;function re(e){this.defaults=e,this.interceptors={request:new tt,response:new tt}}re.prototype.request=function(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=Fe(this.defaults,s),s.method?s.method=s.method.toLowerCase():this.defaults.method?s.method=this.defaults.method.toLowerCase():s.method="get";var n=s.transitional;n!==void 0&&Rt.assertOptions(n,{silentJSONParsing:se.transitional(se.boolean),forcedJSONParsing:se.transitional(se.boolean),clarifyTimeoutError:se.transitional(se.boolean)},!1);var i=[],o=!0;this.interceptors.request.forEach(function(V){typeof V.runWhen=="function"&&V.runWhen(s)===!1||(o=o&&V.synchronous,i.unshift(V.fulfilled,V.rejected))});var r=[];this.interceptors.response.forEach(function(V){r.push(V.fulfilled,V.rejected)});var u;if(!o){var l=[st,void 0];for(Array.prototype.unshift.apply(l,i),l=l.concat(r),u=Promise.resolve(s);l.length;)u=u.then(l.shift(),l.shift());return u}for(var w=s;i.length;){var h=i.shift(),C=i.shift();try{w=h(w)}catch(S){C(S);break}}try{u=st(w)}catch(S){return Promise.reject(S)}for(;r.length;)u=u.then(r.shift(),r.shift());return u};re.prototype.getUri=function(t){t=Fe(this.defaults,t);var s=an(t.baseURL,t.url);return un(s,t.params,t.paramsSerializer)};Bt.forEach(["delete","get","head","options"],function(t){re.prototype[t]=function(s,n){return this.request(Fe(n||{},{method:t,url:s,data:(n||{}).data}))}});Bt.forEach(["post","put","patch"],function(t){function s(n){return function(o,r,u){return this.request(Fe(u||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}re.prototype[t]=s(),re.prototype[t+"Form"]=s(!0)});var ln=re,cn=De;function ue(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(i){t=i});var s=this;this.promise.then(function(n){if(!!s._listeners){var i,o=s._listeners.length;for(i=0;i<o;i++)s._listeners[i](n);s._listeners=null}}),this.promise.then=function(n){var i,o=new Promise(function(r){s.subscribe(r),i=r}).then(n);return o.cancel=function(){s.unsubscribe(i)},o},e(function(i){s.reason||(s.reason=new cn(i),t(s.reason))})}ue.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};ue.prototype.subscribe=function(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]};ue.prototype.unsubscribe=function(t){if(!!this._listeners){var s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}};ue.source=function(){var t,s=new ue(function(i){t=i});return{token:s,cancel:t}};var dn=ue,hn=function(t){return function(n){return t.apply(null,n)}},mn=T,pn=function(t){return mn.isObject(t)&&t.isAxiosError===!0},nt=T,fn=ft,ve=ln,gn=yt,vn=Ge;function Tt(e){var t=new ve(e),s=fn(ve.prototype.request,t);return nt.extend(s,ve.prototype,t),nt.extend(s,t),s.create=function(i){return Tt(gn(e,i))},s}var $=Tt(vn);$.Axios=ve;$.CanceledError=De;$.CancelToken=dn;$.isCancel=kt;$.VERSION=At.version;$.toFormData=Vt;$.AxiosError=ae;$.Cancel=$.CanceledError;$.all=function(t){return Promise.all(t)};$.spread=hn;$.isAxiosError=pn;pt.exports=$;pt.exports.default=$;const it=new Set(["boolean","string","number","undefined"]);function W(e,t=[]){if(it.has(typeof e)||e==null)return e;if(Array.isArray(e))return it.has(typeof e[0])?e.slice():Array.from(e).map(n=>W(n,t));const s={};for(const n in e)t.includes(n)==!1&&typeof e[n]!="function"&&(s[n]=W(e[n],t));return s}function ze(e,t,s=0){const n=e.length-1;return t>n?s:t<s?n:t}function Nt(e,t,s=1/0){return e<t?t:e>s?s:e}function _n(e,t){const s=URL.createObjectURL(e),n=document.createElement("a");n.href=s,n.download=e.name,n.click()}function Ot(e){return new Promise((t,s)=>{const n=document.createElement("input");n.type="file",n.accept=e,n.onchange=()=>{n.files.length?t(n.files[0]):s()},n.onerror=s,n.click()})}function $t(e,t){const s={};for(const n of t)s[n]=e[n];return s}class Lt{constructor(){a(this,"gamepadButtonType","ps");a(this,"useRockerButtons",!0);a(this,"useRockerButtonsType",8);a(this,"timeControllerButtonType","R_Rocker")}}const En={Up:!1,Down:!1,Left:!1,Right:!1,Options:!1,Ok:!1,Cancel:!1,ShowMenu:!1},wn={Up:!1,Down:!1,Left:!1,Right:!1,Select:!1,Start:!1,Fire:!1,Jump:!1,AutoFire:!1,AutoJump:!1},Cn={Save:!1,Load:!1,Time:!1,Slow:!1,Down:!1,Left:!1,Right:!1},Dn={menus:{gamepad:{Up:["Up"],Down:["Down"],Left:["Left"],Right:["Right"],Ok:["FN_Down"],Cancel:["FN_Right"],ShowMenu:["Home"],Options:["Start"]},keyboard:{Up:["Up","W"],Down:["Down","S"],Left:["Left","A"],Right:["Right","D"],Ok:["Enter"],Cancel:["Backspace"],ShowMenu:["Esc","`"],Options:["Alt"]}},gameing:{gamepad:{Up:["Up"],Down:["Down"],Left:["Left"],Right:["Right"],Select:["Select"],Start:["Start"],Fire:["FN_Left"],Jump:["FN_Down"],AutoFire:["FN_Up"],AutoJump:["FN_Right"]},keyboard:{Up:["Up","W"],Down:["Down","S"],Left:["Left","A"],Right:["Right","D"],Select:["Tab"],Start:["Enter"],Fire:["X","J"],AutoFire:["Z","U"],Jump:["C","K"],AutoJump:["I"]}},time:{gamepad:{Save:["L1"],Load:["R1"],Time:["L2"],Slow:["R2"],Down:["Down"],Left:["Left"],Right:["Right"]},keyboard:{Save:["Number_1","F1","Numpad_1"],Load:["Number_2","F2","Numpad_2"],Time:["Space","Alt"],Slow:["Ctrl","MetaLeft"],Down:["Down","S"],Left:["Left","A"],Right:["Right","D"]}}};class Se{constructor(t="",s=!1){this.name=t,this.isNotItem=s}}class M{constructor(t){a(this,"name");a(this,"isOptionsView",!1);a(this,"optionsViewName","");a(this,"list",[]);a(this,"lineSize",0);a(this,"activedIndex",0);a(this,"minIndex",0);a(this,"toggleDirection","");a(this,"actived",!1);a(this,"events",{});Object.assign(this,t)}emit(t,s){return this.events[t]?this.events[t](s):!1}on(t,s){this.events[t]=s}}class Vn extends M{constructor(){super(...arguments);a(this,"message","")}}class Fn extends M{constructor(){super(...arguments);a(this,"message","");a(this,"callback",null);a(this,"toggleDirection","Left/Right");a(this,"defaultOptions",[new J("\u53D6\u6D88",!1),new J("\u786E\u5B9A",!0)])}}class J extends Se{constructor(t="",s=null){super(),this.name=t,this.value=s}}class ne extends Se{constructor(s="",n=""){super();a(this,"canPlay",!0);a(this,"md5","");a(this,"preview","");a(this,"tasScripts",[]);this.name=s,this.romData=n,n&&(this.md5=Zt(n))}static export(s){return $t(s,["name","romData","md5","preview","tasScripts"])}static from(s){return Object.assign(new ne,s)}}class _e extends Se{constructor(s="",n="",i=!1){super();a(this,"selectedOptionIndex",0);a(this,"options");this.name=s,this.key=n,this.isNotItem=i}setOptions(s){return this.options=s,this}setValue(s){const n=this.options.findIndex(i=>i.value==s);return n!=-1&&(this.selectedOptionIndex=n),this}}class _ extends _e{constructor(t=null,s,n=null,i=null){super(s,"",!0),this.type=t,this.name=s,this.from=n,i&&(this.key=i,this.isNotItem=!1,this.setOptions(this.from[this.key].map(o=>({name:o}))))}}class Y extends Se{constructor(t,s){super(),this.name=t,this.viewName=s}}var he=(e=>(e[e.None=0]="None",e[e.Back=6]="Back",e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.Pause=19]="Pause",e[e.Capslock=20]="Capslock",e[e.Esc=27]="Esc",e[e.Space=32]="Space",e[e.Pageup=33]="Pageup",e[e.Pagedown=34]="Pagedown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.Select=41]="Select",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Number_0=48]="Number_0",e[e.Number_1=49]="Number_1",e[e.Number_2=50]="Number_2",e[e.Number_3=51]="Number_3",e[e.Number_4=52]="Number_4",e[e.Number_5=53]="Number_5",e[e.Number_6=54]="Number_6",e[e.Number_7=55]="Number_7",e[e.Number_8=56]="Number_8",e[e.Number_9=57]="Number_9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.MetaLeft=91]="MetaLeft",e[e.MetaRight=93]="MetaRight",e[e.Numpad_0=96]="Numpad_0",e[e.Numpad_1=97]="Numpad_1",e[e.Numpad_2=98]="Numpad_2",e[e.Numpad_3=99]="Numpad_3",e[e.Numpad_4=100]="Numpad_4",e[e.Numpad_5=101]="Numpad_5",e[e.Numpad_6=102]="Numpad_6",e[e.Numpad_7=103]="Numpad_7",e[e.Numpad_8=104]="Numpad_8",e[e.Numpad_9=105]="Numpad_9",e[e["Numpad_*"]=106]="Numpad_*",e[e["Numpad_+"]=107]="Numpad_+",e[e["Numpad_-"]=109]="Numpad_-",e[e.Numpad_Del=110]="Numpad_Del",e[e["Numpad_/"]=111]="Numpad_/",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.Numlock=144]="Numlock",e[e.Scrolllock=145]="Scrolllock",e[e[";"]=186]=";",e[e["="]=187]="=",e[e[","]=188]=",",e[e["-"]=189]="-",e[e["."]=190]=".",e[e["/"]=191]="/",e[e["`"]=192]="`",e[e["["]=219]="[",e[e["\\"]=220]="\\",e[e["]"]=221]="]",e[e["'"]=222]="'",e[e.DpadLeft=1e3]="DpadLeft",e[e.DpadRight=1001]="DpadRight",e[e.DpadUp=1003]="DpadUp",e[e.DpadDown=1004]="DpadDown",e[e.DpadCenter=1005]="DpadCenter",e))(he||{}),bt=(e=>(e[e.Up=12]="Up",e[e.Down=13]="Down",e[e.Left=14]="Left",e[e.Right=15]="Right",e[e.FN_Up=3]="FN_Up",e[e.FN_Down=0]="FN_Down",e[e.FN_Left=2]="FN_Left",e[e.FN_Right=1]="FN_Right",e[e.Select=8]="Select",e[e.Start=9]="Start",e[e.L1=4]="L1",e[e.R1=5]="R1",e[e.L2=6]="L2",e[e.R2=7]="R2",e[e.L3=10]="L3",e[e.R3=11]="R3",e[e.Home=16]="Home",e[e.ScreenShot=17]="ScreenShot",e))(bt||{});class ot{constructor(t,s=1){a(this,"buttons",null);a(this,"_buttons",null);a(this,"lastResult",null);a(this,"angleSplitter",0);a(this,"areaExpand",1);a(this,"angleArea",null);this.areaExpand=s,this.setDirectionsMap(t)}setDirectionsMap(t){this.buttons=t,this._buttons=[...t,t[0]],this.angleSplitter=360/t.length}reset(){this.angleArea=null}updateAngleArea(t){const s=Math.round(t/this.angleSplitter);this.lastResult=this._buttons[s];const n=s*this.angleSplitter%360;return this.angleArea={target:n,min:n-this.angleSplitter/2*this.areaExpand,max:n+this.angleSplitter/2*this.areaExpand},this.lastResult}convert(t){return this.angleArea==null?this.updateAngleArea(t):t<=this.angleArea.max&&t>=this.angleArea.min?this.lastResult:this.angleArea.min<0&&t>=this.angleArea.min+360?this.lastResult:this.updateAngleArea(t)}}class x{constructor(t=0,s=0){this.x=t,this.y=s}mul(t=1){return this.x*=t,this.y*=t,this}static from(t=0,s=0){return typeof t=="number"?new x(t,s):new x(t.x,t.y)}static angleToPosttion(t){let s=Math.sin(t*(Math.PI/180)),n=Math.cos(t*(Math.PI/180));return(t===0||t===180)&&(s=0),(t===90||t===270)&&(n=0),x.from(s,n)}static posttionToAngle(t,s){s||(s=t,t=x.from(0,0));let i=Math.atan2(s.x-t.x,s.y-t.y)*180/Math.PI;if(i>360)i-=360;else if(i<0)i+=360;else if(i==0)return 0;return i}}class Sn{constructor(){a(this,"Up",!1);a(this,"Down",!1);a(this,"Left",!1);a(this,"Right",!1);a(this,"FN_Up",!1);a(this,"FN_Down",!1);a(this,"FN_Left",!1);a(this,"FN_Right",!1);a(this,"Select",!1);a(this,"Start",!1);a(this,"L1",!1);a(this,"L2",!1);a(this,"L3",!1);a(this,"R1",!1);a(this,"R2",!1);a(this,"R3",!1);a(this,"Home",!1);a(this,"ScreenShot",!1)}}class rt extends Sn{constructor(){super(...arguments);a(this,"L_Rocker",new x(0,0));a(this,"R_Rocker",new x(0,0))}}const D=class{constructor(){a(this,"status",new rt);a(this,"rockerDeadzone",.1);a(this,"onlyRockerButtons",!1);a(this,"useRockerButtons",!1);a(this,"useRockerButtonsType",4);a(this,"angleToDirectionConverter",null);a(this,"use_R_RockerButtons",!1);a(this,"use_R_RockerButtonsType",4);a(this,"angleToFunctionsConverter",null);a(this,"onStatusChange",null);a(this,"onButtonUp",null);a(this,"onButtonDown",null);a(this,"onLeftRockerUpdate",null);a(this,"onRightRockerUpdate",null)}static buttons4_to_buttons8(t){return[[t[0]],[t[0],t[1]],[t[1]],[t[2],t[1]],[t[2]],[t[2],t[3]],[t[3]],[t[0],t[3]]]}static emit(t,s){D.events[t]&&D.events[t].forEach(n=>{n(s)})}static on(t,s){D.events[t]||(D.events[t]=new Set),D.events[t].add(s),t=="gamepadconnected"&&D.gamepad&&s()}static off(t,s){D.events[t]&&D.events[t].delete(s)}static offAll(t){delete D.events[t]}static updateAll(){const t=navigator.getGamepads();t==null||t.length==0||D.gamepad==null||!t[D.gamepad.index]||(D.gamepad=t[D.gamepad.index],D.instances.forEach(s=>{s.update()}))}static init(){if(D.inited)return;const t=n=>{D.gamepad=n.gamepad,D.emit("gamepadconnected"),D.autoUpdateInterval=setInterval(D.updateAll,1e3/120)},s=()=>{D.gamepad=null,D.emit("gamepaddisconnected"),clearInterval(D.autoUpdateInterval)};window.addEventListener("gamepadconnected",t),window.addEventListener("gamepaddisconnected",s),D.inited=!0}static destroy(t){D.instances.delete(t)}static create(){D.init();const t=new D;return D.instances.add(t),t}reset(){this.status=new rt}computedDeadzoneValue(t){return this.rockerDeadzone==0?t:Math.abs(t)<this.rockerDeadzone?0:t}setRockerButtons(t,s,n=1.15){const i=D.directionButtons;this.useRockerButtons=t,this.useRockerButtonsType=s,this.angleToDirectionConverter||(this.angleToDirectionConverter=new ot(i,n)),this.angleToDirectionConverter.setDirectionsMap(s==4?i:D.buttons4_to_buttons8(i))}set_R_RockerButtons(t,s,n=1.15){const i=D.functionsButtons;this.use_R_RockerButtons=t,this.use_R_RockerButtonsType=s,this.angleToFunctionsConverter||(this.angleToFunctionsConverter=new ot(i,n)),this.angleToFunctionsConverter.setDirectionsMap(s==4?i:D.buttons4_to_buttons8(i))}update(){const t=D.gamepad;this.updateRockerStatus("L_Rocker",new x(t.axes[0],-t.axes[1])),this.updateRockerStatus("R_Rocker",new x(t.axes[2],-t.axes[3])),this.useRockerButtons&&this.updateRockerButtons("L_Rocker"),this.use_R_RockerButtons&&this.updateRockerButtons("R_Rocker"),t.buttons.forEach((s,n)=>{const i=bt[n];if(this.useRockerButtons&&s.pressed==!1&&D.directionButtons.includes(i)&&(this.status.L_Rocker.x!=0||this.status.L_Rocker.y!=0)){this.updateStatus(i,this.status[i]);return}if(this.use_R_RockerButtons&&s.pressed==!1&&D.functionsButtons.includes(i)&&(this.status.R_Rocker.x!=0||this.status.R_Rocker.y!=0)){this.updateStatus(i,this.status[i]);return}this.updateStatus(i,s.pressed)})}updateRockerButtons(t){const s=t=="L_Rocker"?D.directionButtons:D.functionsButtons,n=this.status[t];if(n.x==0&&n.y==0){if(this.onlyRockerButtons)for(const u of s)this.updateStatus(u,!1);else for(const u of s)this.updateStatus(u,this.status[u]);this.angleToDirectionConverter.reset();return}const i=x.posttionToAngle(this.status[t]),o=(t=="L_Rocker"?this.angleToDirectionConverter:this.angleToFunctionsConverter).convert(i),r=Array.isArray(o)?o:[o];s.forEach(u=>{this.updateStatus(u,r.includes(u))})}updateRockerStatus(t,s){var r,u;const n=this.status[t];let{x:i,y:o}=s;i=this.computedDeadzoneValue(i),o=this.computedDeadzoneValue(o),(n.x!=i||n.y!=o)&&(n.x=i,n.y=o,t=="L_Rocker"?(r=this.onLeftRockerUpdate)==null||r.call(this,n):(u=this.onRightRockerUpdate)==null||u.call(this,n))}updateStatus(t,s){var n,i,o;this.status[t]!=s&&(this.status[t]=s,s?(n=this.onButtonDown)==null||n.call(this,t,this.status):(i=this.onButtonUp)==null||i.call(this,t,this.status),(o=this.onStatusChange)==null||o.call(this,t,this.status))}};let R=D;a(R,"directionButtons",["Up","Right","Down","Left"]),a(R,"functionsButtons",["FN_Up","FN_Right","FN_Down","FN_Left"]),a(R,"events",{}),a(R,"gamepad",null),a(R,"instances",new Set),a(R,"inited",!1),a(R,"autoUpdateInterval",null);const ie=class{constructor(t,s){a(this,"_status",null);a(this,"status",null);a(this,"paused",!1);a(this,"name","");a(this,"gamepadController",null);a(this,"onStatusChange",null);a(this,"onButtonDown",null);a(this,"onButtonHold",null);a(this,"onButtonUp",null);a(this,"gamepadBindingData",null);a(this,"keyBoardBindingData",null);a(this,"gamepadBindingDataParsed",null);a(this,"KeyBoardBindingDataParsed",null);a(this,"autoPressTime",1e3/30);a(this,"autoPressBeforeTime",300);a(this,"autoPressButtons",null);a(this,"autoPressButtonsTimer",null);a(this,"holdBeforeTime",300);a(this,"holdButtonsStatus",null);a(this,"holdButtonsTimer",null);a(this,"holdButtons",null);a(this,"KeyBoardStatus",null);a(this,"onKeyDown");a(this,"onKeyUp");ie.controllers.set(t,this),this.name=t,this._status=s,this.reset()}static pauseAll(){ie.controllers.forEach(t=>t.pause())}static resumeAll(){ie.controllers.forEach(t=>t.resume())}static updateBindingData(){ie.controllers.forEach(t=>{t.bindGamepad(t.gamepadBindingData),t.bindKeyBoard(t.keyBoardBindingData)})}reset(){this.status=W(this._status)}pause(){this.stopAutoPress(),this.paused=!0}resume(){this.paused=!1}destroy(){this.pause(),this.onButtonDown=null,this.onButtonUp=null,this.onStatusChange=null,R.destroy(this.gamepadController),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),this.gamepadController&&(this.gamepadController=null),this.status=null}initKeyboard(){this.onKeyDown=t=>{const s=he[t.keyCode];this.KeyBoardBindingDataParsed.has(s)&&t.preventDefault(),this.updateKeyboard(t.keyCode,!0)},this.onKeyUp=t=>{this.updateKeyboard(t.keyCode,!1)},window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),window.addEventListener("blur",()=>{this.KeyBoardBindingDataParsed.forEach((t,s)=>{this.updateKeyboard(he[s],!1)})})}initGamePad(){this.gamepadController=R.create(),this.gamepadController.onButtonDown=(t,s)=>{this.updateGamepad(t,!0)},this.gamepadController.onButtonUp=(t,s)=>{this.updateGamepad(t,!1)}}setAutoPressButtons(t){this.autoPressButtons=t}startAutoPress(t){!this.autoPressButtons||(this.stopAutoPress(),this.autoPressButtons.indexOf(t)==-1)||(this.autoPressButtonsTimer=setTimeout(()=>{const n=()=>{var i;(i=this.onButtonDown)==null||i.call(this,t),this.autoPressButtonsTimer=setTimeout(n,this.autoPressTime)};n()},this.autoPressBeforeTime))}stopAutoPress(){clearTimeout(this.autoPressButtonsTimer)}getButtonIsHold(t){return!this.holdButtons||this.holdButtons.includes(t)==!1?!1:this.holdButtonsStatus.get(t)}setHoldButtons(t){this.holdButtons=t,this.holdButtonsTimer=new Map,this.holdButtonsStatus=new Map}startHoldButton(t){if(!this.holdButtons||this.holdButtons.includes(t)==!1)return;const s=setTimeout(()=>{var n;this.holdButtonsStatus.set(t,!0),(n=this.onButtonHold)==null||n.call(this,t)},this.holdBeforeTime);this.holdButtonsStatus.set(t,!1),this.holdButtonsTimer.set(t,s)}stopHoldButton(t){!this.holdButtons||this.holdButtons.includes(t)==!1||clearTimeout(this.holdButtonsTimer.get(t))}updateStatus(t,s){var n,i,o;if(this.status[t]!=s){if(this.status[t]=s,this.paused)return;s?((n=this.onButtonDown)==null||n.call(this,t),this.startAutoPress(t),this.startHoldButton(t)):((i=this.onButtonUp)==null||i.call(this,t,this.getButtonIsHold(t)),this.stopAutoPress(),this.stopHoldButton(t)),(o=this.onStatusChange)==null||o.call(this,t)}}bindKeyBoard(t){this.keyBoardBindingData=t,this.KeyBoardBindingDataParsed=new Map,this.KeyBoardStatus=new Map;for(let s in t)t[s].forEach(n=>{this.KeyBoardBindingDataParsed.set(n,s),this.KeyBoardStatus.set(n,!1)})}bindGamepad(t){this.gamepadBindingData=t,this.gamepadBindingDataParsed=new Map;for(let s in t)t[s].forEach(n=>{this.gamepadBindingDataParsed.set(n,s)})}updateGamepad(t,s){if(!this.gamepadBindingDataParsed.has(t))return;const n=this.gamepadBindingDataParsed.get(t);s==!0&&this.status[n]==!0&&this.paused==!1&&this.onButtonDown(n),this.updateStatus(n,s)}updateKeyboard(t,s){const n=he[t];if(!this.KeyBoardBindingDataParsed.has(n)||this.KeyBoardStatus.get(n)==s)return;const i=this.KeyBoardBindingDataParsed.get(n);s==!0&&this.status[i]==!0&&this.KeyBoardStatus.get(n)==!1&&this.paused==!1&&this.onButtonDown(i),this.KeyBoardStatus.set(n,s),this.updateStatus(i,s)}};let j=ie;a(j,"controllers",new Map);window.GameController=j;const be=256,Ie=240,kn=be*Ie,fe=1024*2**1,ut=48e3,at={0:64,1:65,64:0,65:1},Re=localforage.createInstance({storeName:"autoSavedDatas",name:"autoSavedDatas"});class yn{constructor(){a(this,"frameCount",0);a(this,"replayDatas",[]);a(this,"replayModel",!1);a(this,"paused",!0);a(this,"onCanvasUpdate",t=>{});a(this,"canvasElement",document.createElement("canvas"));a(this,"ctx",this.canvasElement.getContext("2d"));a(this,"imageData",this.ctx.getImageData(0,0,be,Ie));a(this,"buffer",new ArrayBuffer(this.imageData.data.length));a(this,"buffer8",new Uint8ClampedArray(this.buffer));a(this,"buffer32",new Uint32Array(this.buffer));a(this,"startTime",0);a(this,"timeControllerStatus","");a(this,"savedDatas",null);a(this,"autoSavedFrames",null);a(this,"autoSavedDataCount",0);a(this,"md5","");a(this,"romData",null);a(this,"_nes",null);a(this,"gameController",null);a(this,"volume",1);a(this,"audioContent",null);a(this,"script_processor",null);a(this,"gainNode",null);a(this,"audio_L",[]);a(this,"audio_R",[]);a(this,"playSpeed",1);a(this,"playSpeedFrameCount",0);a(this,"animationFrameHandle",null);a(this,"autoFire",!1);a(this,"autoJump",!1);a(this,"frameTime",1e3/60);a(this,"frameTimer",0);a(this,"lastFrameTime",Date.now());a(this,"update",()=>{if(!this.paused){if(this.frameTimer<this.frameTime){const t=Date.now();this.frameTimer+=t-this.lastFrameTime,this.lastFrameTime=t,this.frameTimer<this.frameTime?this.animationFrameHandle=requestAnimationFrame(this.update):this.update();return}if(this.frameTimer>this.frameTime*4&&(this.frameTimer=this.frameTime),this.frameTimer-=this.frameTime,this._nes.romData)if(this.playSpeed==1)this.updateOneFrame();else if(this.playSpeed>1)for(let t=0;t<this.playSpeed;t++)this.updateOneFrame();else this.playSpeedFrameCount+=this.playSpeed,this.playSpeedFrameCount>=1&&(this.updateOneFrame(),this.playSpeedFrameCount=0);this.frameTimer<this.frameTime?this.animationFrameHandle=requestAnimationFrame(this.update):this.update()}});this.canvasElement.width=be,this.canvasElement.height=Ie,window.nesPlayer=this,document.addEventListener("visibilitychange",()=>{var t,s;document.visibilityState=="hidden"?(t=this.audioContent)==null||t.suspend():(s=this.audioContent)==null||s.resume()}),this.initNes()}destroy(){var t,s;(t=this.audioContent)==null||t.suspend(),(s=this.script_processor)==null||s.disconnect(),this.stopUpdate(),this.gameController.destroy(),this._nes.reset()}pause(){this.paused=!0,this.gameController.pause(),this.stopUpdate()}resume(){this.paused!=!1&&(this.gameController.resume(),this.paused=!1,this.update())}setPlaySpeed(t){var s,n;this.playSpeed=t,this.playSpeedFrameCount=0,this.audio_L=[],this.audio_R=[],this.playSpeed==1?(this._nes.opts.emulateSound=!0,(s=this.audioContent)==null||s.resume()):(this._nes.opts.emulateSound=!1,(n=this.audioContent)==null||n.suspend())}loadGame(t,s=!1,n=""){this._nes.loadROM(t),this.initAudio(),this.openAduio(),this.stopUpdate(),this.replayModel=s,this.frameCount=0,this.autoSavedDataCount=0,this.autoSavedFrames=[],this.startTime=Date.now(),this.romData=t,this.md5=this.md5||n,Re.clear(),this.replayModel==!1&&(this.replayDatas=[]),this.mute_200ms(),this.update()}initNes(){this._nes&&this._nes.reset(),this._nes=new jsnes.NES({sampleRate:ut,onFrame:t=>{if(this.timeControllerStatus!="continue"){for(var s=0;s<kn;s++)this.buffer32[s]=4278190080|t[s];if(this.onFrameUpdate({frameCount:this.frameCount,data:this.toCompressedFrameData(this.buffer32)}),this.playSpeed>1){if(this.playSpeedFrameCount++,this.playSpeedFrameCount<this.playSpeed)return;this.playSpeedFrameCount=0}this.imageData.data.set(this.buffer8),this.ctx.putImageData(this.imageData,0,0),this.audio_L.length>=fe*4&&(this.audio_L=this.audio_L.slice(fe),this.audio_R=this.audio_R.slice(fe))}},onAudioSample:(t,s)=>{this.playSpeed==1&&(this.audio_L.push(t),this.audio_R.push(s))}})}initGameController(t,s){if(this.gameController){this.gameController.bindGamepad(t),this.gameController.bindKeyBoard(s);return}const n=new Map;n.set("Up",jsnes.Controller.BUTTON_UP),n.set("Down",jsnes.Controller.BUTTON_DOWN),n.set("Left",jsnes.Controller.BUTTON_LEFT),n.set("Right",jsnes.Controller.BUTTON_RIGHT),n.set("Select",jsnes.Controller.BUTTON_SELECT),n.set("Start",jsnes.Controller.BUTTON_START),n.set("Fire",jsnes.Controller.BUTTON_B),n.set("Jump",jsnes.Controller.BUTTON_A);const i=new j("NESPlayer",wn);i.bindGamepad(t),i.bindKeyBoard(s),i.onButtonDown=o=>{var r;((r=this.audioContent)==null?void 0:r.state)=="suspended"&&this.openAduio(),o=="AutoFire"?this.autoFire=!0:o=="AutoJump"?this.autoJump=!0:n.has(o)&&this._nes.buttonDown(1,n.get(o))},i.onButtonUp=o=>{o=="AutoFire"?(this.autoFire=!1,this._nes.buttonUp(1,jsnes.Controller.BUTTON_B)):o=="AutoJump"?(this.autoJump=!1,this._nes.buttonUp(1,jsnes.Controller.BUTTON_A)):n.has(o)&&this._nes.buttonUp(1,n.get(o))},i.initGamePad(),i.initKeyboard(),this.gameController=i}initTasScript(t){this.replayDatas=t.split(`
`).filter(s=>/^\|0\|/.test(s)).map(s=>[s[10]=="."?0:1,s[9]=="."?0:1,s[8]=="."?0:1,s[7]=="."?0:1,s[6]=="."?0:1,s[5]=="."?0:1,s[4]=="."?0:1,s[3]=="."?0:1])}openAduio(){this.audio_L=[],this.audio_R=[],this.audioContent&&this.audioContent.state=="suspended"&&this.audioContent.createBufferSource().start()}setVolume(t){this.volume=t,this.gainNode&&(this.gainNode.gain.value=t)}mute_200ms(){const t=this.volume;this.setVolume(0),setTimeout(()=>{this.setVolume(t)},200)}initAudio(){this.audioContent||(this.audioContent=new AudioContext({sampleRate:ut}),this.gainNode=this.audioContent.createGain(),this.gainNode.connect(this.audioContent.destination),this.setVolume(this.volume),this.script_processor=this.audioContent.createScriptProcessor(fe,0,2),this.script_processor.connect(this.gainNode),this.script_processor.onaudioprocess=t=>{if(this.audio_L.length==0)return;const s=t.outputBuffer.length;if(this.audio_L.length<s)return;const n=t.outputBuffer.getChannelData(0),i=t.outputBuffer.getChannelData(1);for(var o=0;o<s;o++)n[o]=this.audio_L[o],i[o]=this.audio_R[o];this.audio_L=this.audio_L.slice(s),this.audio_R=this.audio_R.slice(s)})}async timeContinue(){if(this.timeControllerStatus=="")return;const t=this.frameCount;this.timeControllerStatus="continue";const s=Math.floor(t/60);let n=await Re.getItem("Data-"+s);n||(n=this.savedDatas.find(o=>o.frameCount==t+1)),this.loadData(n,this.romData);let i=this.replayModel;for(this.replayModel=!0,this.frameCount++;this.frameCount<t;)this.updateOneFrame();this.replayModel=i,this.timeControllerStatus="",this.replayModel==!1&&(this.replayDatas.length=t),this.syncControllerStatus()}syncControllerStatus(){const t=this.gameController.status;for(let s in t)s=="AutoFire"||s=="AutoJump"||(t[s]==!0?this.gameController.onButtonDown(s):this.gameController.onButtonUp(s,!1))}decompressToBuffer32({colors:t,datas:s}){let n=0;for(let i=0;i<s.length;i+=2){const o=s[i+1]==0?256:s[i+1],r=t[s[i]];this.buffer32.fill(r,n,n+=o)}}toCompressedFrameData(t){const s=[],n=[];let i=null,o=0;for(let r=0;r<t.length;r++){let u=s.indexOf(t[r]);u==-1&&(s.push(t[r]),u=s.length-1),r%256==0?(r!=0&&n.push(i,o),i=u,o=1):i!=u?(n.push(i,o),i=u,o=1):o++}return n.push(i,o),{colors:Uint32Array.from(s),datas:Uint8Array.from(n)}}onFrameUpdate(t){const s=this.frameCount;if(this.autoSavedFrames.length-1>s&&(this.autoSavedFrames.length=s),this.autoSavedFrames[s]=t,s%60==0){const n=W(this.saveData()),i=n.frameCount/60;this.autoSavedDataCount=i,Re.setItem("Data-"+i,n)}this.autoSavedFrames.length>=18e3&&delete this.autoSavedFrames[this.autoSavedFrames.length-18e3],this.onCanvasUpdate(this.frameCount)}justUpdateCanvas(){if(this.timeControllerStatus=="paused")return;const t=this.frameCount+(this.timeControllerStatus=="forward"?1:-1);this.frameCount=Nt(t,0);const s=this.autoSavedFrames[this.frameCount];if(!s){this.timeControllerStatus="paused",this.onCanvasUpdate(this.frameCount);return}this.decompressToBuffer32(s.data),this.imageData.data.set(this.buffer8),this.ctx.putImageData(this.imageData,0,0),(this.timeControllerStatus=="back"&&this.frameCount==0||this.timeControllerStatus=="forward"&&this.frameCount==this.autoSavedFrames.length-1)&&(this.timeControllerStatus="paused"),this.onCanvasUpdate(this.frameCount)}updateOneFrame(){if(this.timeControllerStatus=="paused"||this.timeControllerStatus=="back"||this.timeControllerStatus=="forward"){this.justUpdateCanvas();return}const t=this._nes.controllers[1];if(this.replayModel){const s=this.replayDatas[this.frameCount];s&&(t.state=s.map(n=>at[n]))}else this.autoFire&&(t.state[1]=t.state[1]==64?65:64),this.autoJump&&(t.state[0]=t.state[0]==64?65:64);this.replayModel==!1&&this.timeControllerStatus==""&&this.replayDatas.push(t.state.map(s=>at[s])),this._nes.frame(),this.frameCount++}stopUpdate(){cancelAnimationFrame(this.animationFrameHandle)}saveData(){const t=this._nes.toJSON(),s=$t(this._nes.papu,["dmc","triangle","square1","square2","noise"]),n=W(s,["papu"]);return t.papu=n,delete t.romData,{data:t,startTime:this.startTime,frameCount:this.frameCount,replayDatas:this.replayDatas}}loadData(t,s){this.frameCount=t.frameCount,t.data.romData=s,this._nes.romData||this.loadGame(s,this.replayModel),this._nes.fromJSON(t.data),t.data.papu&&(this._nes.papu.reset(),Object.assign(this._nes.papu.dmc,t.data.papu.dmc),Object.assign(this._nes.papu.triangle,t.data.papu.triangle),Object.assign(this._nes.papu.square1,t.data.papu.square1),Object.assign(this._nes.papu.square2,t.data.papu.square2),Object.assign(this._nes.papu.noise,t.data.papu.noise)),this.mute_200ms()}async initSavedData(t){this.savedDatas=await localforage.getItem("NES:"+t)||[]}async save(){const t=W(this.saveData());t.name="",t.createdTime=Date.now(),t.preview=this.canvasElement.toDataURL("image/png"),this.savedDatas.unshift(t),this.savedDatas.length=2,localforage.setItem("NES:"+this.md5,this.savedDatas)}async load(t=0){if(this.savedDatas[t]){const s=W(this.savedDatas[t]);this.replayDatas=s.replayDatas,this.loadData(s,this.romData)}}}async function Te(e){return new Promise((t,s)=>{var n=new XMLHttpRequest;n.open("GET",e),n.overrideMimeType("text/plain;charset=x-user-defined"),n.onload=function(){this.status===200?t(this.responseText):this.status===0||s(n)},n.onerror=s,n.send()})}const L=Xt("main",{state:()=>{let e=W(Dn);localStorage.getItem("GameControllerBindingDatas")&&(e=JSON.parse(localStorage.getItem("GameControllerBindingDatas")));let t=new Lt;return localStorage.getItem("GameConfig")&&(t=JSON.parse(localStorage.getItem("GameConfig"))),{showMenu:!1,gamepadConnected:!1,selectedGame:null,lastFouseTargetElement:null,fouseTargetElement:null,gameControllerBindDatas:e,gameConfig:t,activedView:"Menus",viewHistory:["Menus"],views:{Menus:new M({name:"Menus",toggleDirection:"Up/Down",list:[new Y("\u9009\u62E9\u6E38\u620F","Games"),new Y("\u622A\u56FE","Screenshot"),new Y("\u8BBE\u7F6E","Setting"),new Y("\u624B\u67C4\u6309\u952E\u8BBE\u7F6E","Hotkeys_Gamepad"),new Y("\u952E\u76D8\u6309\u952E\u8BBE\u7F6E","Hotkeys_Keyboard"),new Y("\u5E2E\u52A9\u4FE1\u606F","Help"),new Y("\u5207\u6362\u5168\u5C4F","ToggleFullScene"),new Y("\u5173\u95ED\u83DC\u5355","CloseMenu")],actived:!0}),Games:new M({name:"Games",optionsViewName:"GamesOptions",toggleDirection:"",minIndex:-1}),GamesOptions:new M({name:"GamesOptions",isOptionsView:!0,toggleDirection:"Up/Down",list:[new J("\u5F00\u59CB\u6E38\u620F","PlayGame"),new J("\u79FB\u9664\u9884\u89C8\u56FE","RemovePreview"),new J("\u91CD\u547D\u540D","RenameGame"),new J("\u79FB\u9664\u6E38\u620F","RemoveGame")]}),Setting:new M({name:"Setting",toggleDirection:"Up/Down",minIndex:-1}),Hotkeys_Keyboard:new M({name:"Hotkeys_Keyboard",optionsViewName:"HotkeysOptions",toggleDirection:"Up/Down",minIndex:-1}),Hotkeys_Gamepad:new M({name:"Hotkeys_Gamepad",optionsViewName:"HotkeysOptions",toggleDirection:"Up/Down",minIndex:-1}),HotkeysInputer:new M({name:"HotkeysInputer"}),HotkeysOptions:new M({name:"HotkeysOptions",isOptionsView:!0,toggleDirection:"Up/Down",list:[new J("\u4FEE\u6539","SetHotkey"),new J("\u79FB\u9664","RemoveHotkey")]}),Help:new M({name:"Help",toggleDirection:"Up/Down"}),Alert:new Vn({name:"Alert"}),Confirm:new Fn({name:"Confirm"})}}},actions:{toggleActivedView(e,t="push"){if(e==this.activedView)return;switch(t){case"push":this.viewHistory.push(e);break;case"back":this.viewHistory.pop(),e=this.viewHistory[this.viewHistory.length-1];break;case"replace":this.viewHistory.length>1&&this.viewHistory.pop(),this.viewHistory.push(e);break}let s=this.views[this.activedView];s.actived=!1,this.activedView=e,s=this.views[this.activedView],s.actived=!0},runOption(e,t){const s=this.views[e];!s||(this.toggleActivedView("","back"),s.emit("Option",t))},buttonDown_ShowMenu(){const e=this.views[this.activedView];e.emit("ButtonDown","ShowMenu")||e.isOptionsView||(this.showMenu=!this.showMenu)},buttonDown_Direction(e){const t=this.views[this.activedView];if(t.emit("ButtonDown",e))return;let s=0;t.toggleDirection=="Up/Down"?e=="Up"?s=-1:e=="Down"&&(s=1):t.toggleDirection=="Left/Right"?e=="Left"?s=-1:e=="Right"&&(s=1):e=="Left"?s=-1:e=="Right"?s=1:e=="Up"?s=-t.lineSize:e=="Down"&&(s=t.lineSize),s!=0&&(t.activedIndex=ze(t.list,t.activedIndex+s,t.minIndex),t.activedIndex!=-1&&t.list[t.activedIndex].isNotItem&&this.buttonDown_Direction(e))},buttonDown_Cancel(){this.views[this.activedView].emit("ButtonDown","Cancel")||this.toggleActivedView("","back")},buttonDown_Ok(){const e=this.views[this.activedView];if(e.emit("ButtonDown","Ok"))return;const t=e.list[e.activedIndex];if("viewName"in t){this.toggleActivedView(t.viewName);return}if(e.isOptionsView){const s=this.viewHistory[this.viewHistory.length-2];this.runOption(s,t);return}},buttonDown_Options(){const e=this.views[this.activedView];if(e.emit("ButtonDown","Options"))return;if(e.isOptionsView){this.toggleActivedView("","back");return}const t=e.list[e.activedIndex];!t||t.isNotItem||e.optionsViewName&&this.toggleActivedView(e.optionsViewName)},alert(e){this.views.Alert.message=e,this.toggleActivedView("Alert")},async confirm(e,t=null){return await new Promise((s,n)=>{const i=this.views.Confirm;i.message=e,i.list=t||i.defaultOptions,i.callback=o=>{if(i.list==i.defaultOptions){o==!0?s(o):n(o);return}s(o),i.callback=null},this.toggleActivedView("Confirm")})},updateFocusTargetElement(e){this.lastFouseTargetElement=this.fouseTargetElement,this.fouseTargetElement=e},async saveGameList(){await localforage.setItem("games",W(this.views.Games.list))},saveHotkeyData(){localStorage.setItem("GameControllerBindingDatas",JSON.stringify(this.gameControllerBindDatas))},saveGameConfigData(){localStorage.setItem("GameConfig",JSON.stringify(this.gameConfig))},playGame(e){if(this.selectedGame==e){this.showMenu=!1;return}this.selectedGame=e,localStorage.setItem("LastPlayingGame",e.md5)}}});var N=(e,t)=>{const s=e.__vccOpts||e;for(const[n,i]of t)s[n]=i;return s};function It(e){let t=e.parentElement,s=!1;for(let n=0;n<3;n++){if(getComputedStyle(t).overflow=="auto"){s=!0;break}t=t.parentElement}return s?t:null}const An=Vue.defineComponent({setup(){return{el:Vue.ref(),store:L()}},props:{view:null,index:{type:Number,default:0},tagName:{type:String,default:"div"}},computed:{__selected(){return this.view.activedIndex==this.index},__hover(){const e=this.__selected&&this.view.actived;return e&&(this.updateScrollTop(),this.updateRect()),e}},watch:{"store.showMenu"(){this.__hover&&this.$nextTick(this.updateRect)}},methods:{showOptions(){this.store.buttonDown_Options()},onMouseEnter(){this.view.activedIndex=this.index,this.store.toggleActivedView(this.view.name,"replace")},updateFocusTargetElement(){this.store.updateFocusTargetElement(this.el)},updateRect(){!this.el||this.$nextTick(()=>{this.el.getClientRects().length!=0&&this.updateFocusTargetElement()})},updateScrollTop(){if(!this.el)return;let e=It(this.el);if(!e)return;const t=this.el.offsetTop,s=t+this.el.offsetHeight,n=e.scrollTop,i=e.offsetHeight,o=n+i;s>o?e.scrollTop=s-i+32:t<n&&(e.scrollTop=t-40)}}});function Bn(e,t,s,n,i,o){return Vue.openBlock(),Vue.createBlock(Vue.resolveDynamicComponent(e.tagName),{ref:"el",class:"FocusTarget","data-hover":e.__hover,"data-selected":e.__selected,onMousemove:e.onMouseEnter,onContextmenu:Vue.withModifiers(e.showOptions,["prevent"])},{default:Vue.withCtx(()=>[Vue.renderSlot(e.$slots,"default")]),_:3},40,["data-hover","data-selected","onMousemove","onContextmenu"])}var X=N(An,[["render",Bn]]);const Rn=Vue.defineComponent({props:{title:{type:String,default:""},background:String}}),Tn={class:"dialog"},Nn={class:"dialog-content"},On={class:"dialog-title flex center"},$n={class:"dialog-main"};function Ln(e,t,s,n,i,o){return Vue.openBlock(),Vue.createElementBlock("div",Tn,[Vue.createElementVNode("div",{class:"dialog-bg",style:Vue.normalizeStyle({background:e.background}),onClick:t[0]||(t[0]=r=>e.$emit("clickOverlay"))},null,4),Vue.createElementVNode("div",Nn,[Vue.createElementVNode("div",On,Vue.toDisplayString(e.title),1),Vue.createElementVNode("div",$n,[Vue.renderSlot(e.$slots,"default")])])])}var le=N(Rn,[["render",Ln]]);const bn=Vue.defineComponent({setup(){return{scrollerElement:null,store:L()}},data(){return{style:null}},watch:{"store.showMenu"(){this.store.showMenu==!0&&this.$nextTick(this.updateStyle)},"store.fouseTargetElement"(){this.updateStyle(),this.updateScrollerElement()}},methods:{updateScrollerElement(){this.scrollerElement&&(this.scrollerElement.removeEventListener("scroll",this.updateStyle),this.scrollerElement=null);const e=It(this.store.fouseTargetElement);!e||(this.scrollerElement=e,this.scrollerElement.addEventListener("scroll",this.updateStyle))},updateStyle(){const e=this.store.fouseTargetElement;if(!e)return null;const t=e.getBoundingClientRect(),s=getComputedStyle(e);this.style={display:"block",top:t.top+"px",left:t.left+"px",width:t.width+"px",height:t.height+"px",borderRadius:s.borderRadius}}},mounted(){window.addEventListener("resize",this.updateStyle)}});function In(e,t,s,n,i,o){return e.store.showMenu?(Vue.openBlock(),Vue.createElementBlock("div",{key:0,class:"Focused",style:Vue.normalizeStyle(e.style)},null,4)):Vue.createCommentVNode("",!0)}var xn=N(bn,[["render",In]]);const Mn=Vue.defineComponent({setup(){return{gridElement:Vue.ref(),store:L()}},components:{FocusTarget:X},data(){return{inited:!1}},computed:{__games(){return this.store.views.Games}},methods:{playGame(e){this.__games.activedIndex=e,this.store.playGame(this.__games.list[this.__games.activedIndex])},async downloadTestGame(){try{const e=await Te("./nes/enola.nes"),t=new ne("enola.nes",e);this.addGameItem(t)}catch{alert("\u4E0B\u8F7D\u6D4B\u8BD5\u6E38\u620F\u5931\u8D25!")}},async downloadOtherTestGame(){await this.store.confirm("\u786E\u5B9A\u4E0B\u8F7D\u66F4\u591A\u6D4B\u8BD5\u6E38\u620F?");try{const e=JSON.parse(await(await fetch("./other-nes/list.json")).text()),t=this.__games.list.map(n=>n.name),s=e.filter(n=>t.includes(n)==!1);if(s.length==0){this.store.alert("\u6682\u65F6\u6CA1\u6709\u66F4\u591A\u6D4B\u8BD5\u6E38\u620F\u4E86!");return}for(const n of s.slice(0,10)){const i=await Te(`./other-nes/${n}`),o=new ne(n,i);this.addGameItem(o)}this.store.alert(`\u4E0B\u8F7D\u4E86${s.slice(0,10).length}\u4E2A\u65B0\u7684\u6D4B\u8BD5\u6E38\u620F!`)}catch{alert("\u4E0B\u8F7D\u6D4B\u8BD5\u6E38\u620F\u5931\u8D25!")}},async addNewGame(e=null){const t=e||await Ot(".nes,.zip");if(t.type=="application/zip"){const n=new jszip;await n.loadAsync(t);const i=Object.keys(n.files).filter(o=>/\.nes$/i.test(o)).sort();for(const o of i){const r=await n.file(o).async("blob");r.size>10*1024&&await this.addNewGame(new File([r],o.match(/[^\/]+$/)[0]))}return}const s=await Te(URL.createObjectURL(t));this.addGameItem(new ne(t.name,s))},async addGameItem(e){if(this.__games.list.find(t=>t.md5==e.md5)){this.store.alert("\u8BE5\u6E38\u620F\u5DF2\u5B58\u5728 !");return}this.__games.list.push(e),this.__games.activedIndex=this.__games.list.length-1,this.store.saveGameList()},async loadGameList(){return(await localforage.getItem("games")||[]).map(ne.from)},moveListIndex(){if(this.__games.list.length==0)return this.__games.activedIndex=this.__games.activedIndex==0?-1:0,!0},updateLineSize(){this.__games.lineSize=getComputedStyle(this.gridElement).gridTemplateColumns.split(" ").length},async init(){this.__games.list=await this.loadGameList();let e=null;localStorage.getItem("LastPlayingGame")&&(e=this.__games.list.find(n=>n.md5==localStorage.getItem("LastPlayingGame"))),e?(this.__games.activedIndex=this.__games.list.indexOf(e),this.store.playGame(e)):this.store.showMenu=!0;const t=["Up","Up","Down","Down","Left","Right","Left","Right","Cancel","Ok","Cancel","Ok"],s=[];this.__games.on("ButtonDown",n=>{if(t[s.length]==n&&(s.push(n),t.length==s.length&&(s.length=0,this.downloadOtherTestGame()),n=="Cancel"||n=="Ok"||n=="Options"))return!0;switch(n){case"Up":case"Down":this.updateLineSize();return;case"Right":case"Left":return this.moveListIndex();case"Ok":return this.__games.activedIndex==-1?(this.addNewGame(),!0):this.__games.list.length==0?(this.downloadTestGame(),!0):(this.playGame(this.__games.activedIndex),this.store.buttonDown_Cancel(),!0)}}),this.__games.on("Option",n=>{const i=this.__games.list[this.__games.activedIndex];if(n.value=="PlayGame")this.playGame(this.__games.activedIndex);else if(n.value=="RenameGame"){let o=prompt("\u8F93\u5165\u65B0\u540D\u79F0",i.name);o&&o.trim()&&(i.name=o.trim(),this.store.saveGameList())}else n.value=="RemovePreview"?(i.preview="",this.store.saveGameList()):n.value=="RemoveGame"?(this.__games.list.splice(this.__games.activedIndex,1),this.__games.list.length-1<this.__games.activedIndex&&this.__games.activedIndex--,this.store.saveGameList()):console.log(n)}),this.inited=!0}},mounted(){this.init()}}),Un={class:"game-list"},Pn={class:"game-list-grid",ref:"gridElement"},Hn={class:"game-item-preview flex-item flex center"},Gn=["src"],jn={class:"game-item-name flex-item expand flex center"},zn={class:"game-item-name-target"},qn=Vue.createElementVNode("div",{class:"game-item-name flex-item expand flex center"},[Vue.createElementVNode("span",{class:"game-item-name-target",style:{"font-size":"16px"}},"\u4E0B\u8F7D\u6D4B\u8BD5\u6E38\u620F")],-1),Jn=Vue.createElementVNode("div",{class:"game-item-name flex-item expand flex center"},[Vue.createElementVNode("span",{class:"game-item-name-target",style:{"font-size":"16px"}},"\u6DFB\u52A0\u6E38\u620F")],-1);function Wn(e,t,s,n,i,o){const r=Vue.resolveComponent("FocusTarget");return Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",Un,[Vue.createElementVNode("div",Pn,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.__games.list,(u,l)=>(Vue.openBlock(),Vue.createBlock(r,{class:"game-item flex top",view:e.__games,index:l,"data-canplay":u.canPlay,onClick:w=>e.playGame(l)},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",Hn,[u.preview?(Vue.openBlock(),Vue.createElementBlock("img",{key:0,class:"game-item-preview-target",src:u.preview},null,8,Gn)):Vue.createCommentVNode("",!0)]),Vue.createElementVNode("div",jn,[Vue.createElementVNode("span",zn,Vue.toDisplayString(u.name),1)])]),_:2},1032,["view","index","data-canplay","onClick"]))),256)),e.__games.list.length==0?(Vue.openBlock(),Vue.createBlock(r,{key:0,class:"game-item flex top",view:e.__games,onClick:e.downloadTestGame},{default:Vue.withCtx(()=>[qn]),_:1},8,["view","onClick"])):Vue.createCommentVNode("",!0),Vue.createVNode(r,{class:"game-item flex top",view:e.__games,index:-1,onClick:t[0]||(t[0]=u=>e.addNewGame())},{default:Vue.withCtx(()=>[Jn]),_:1},8,["view"])],512)],512)),[[Vue.vShow,e.inited]])}var Xn=N(Mn,[["render",Wn]]);const Yn=Vue.defineComponent({components:{FocusTarget:X},props:{item:Object,view:M,index:Number}}),Zn={key:0,class:"Setting-title"},Qn={class:"Setting-item-name flex-item"},Kn={class:"Setting-item-content flex-item expand"},ei={class:"Setting-item-options flex acenter"},ti=["data-selected","onClick"];function si(e,t,s,n,i,o){const r=Vue.resolveComponent("FocusTarget");return e.item.isNotItem?(Vue.openBlock(),Vue.createElementBlock("strong",Zn,Vue.toDisplayString(e.item.name),1)):(Vue.openBlock(),Vue.createBlock(r,{key:1,class:"Setting-item flex acenter",view:e.view,index:e.index},{default:Vue.withCtx(()=>[Vue.createElementVNode("span",Qn,Vue.toDisplayString(e.item.name)+" :",1),Vue.createElementVNode("span",Kn,[Vue.createElementVNode("div",ei,[e.$slots.option?(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,{key:0},Vue.renderList(e.item.options,(u,l)=>Vue.renderSlot(e.$slots,"option",{option:u,optionIndex:l})),256)):(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,{key:1},Vue.renderList(e.item.options,(u,l)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"Setting-item-option","data-selected":e.item.selectedOptionIndex==l,onClick:w=>e.$emit("clickOption",{item:e.item,optionIndex:l})},Vue.toDisplayString(u.name),9,ti))),256)),Vue.renderSlot(e.$slots,"otherOption")])])]),_:3},8,["view","index"]))}var xt=N(Yn,[["render",si]]);const ni=Vue.defineComponent({components:{SettingItem:xt},setup(){return{store:L()}},data(){return{inited:!1}},computed:{__setting(){return this.store.views.Setting},__gameConfig(){return this.store.gameConfig},__settedGameConfig(){const e=new Lt;for(const t of this.__setting.list)t.isNotItem==!1&&(e[t.key]=t.options[t.selectedOptionIndex].value);return e}},watch:{__settedGameConfig(){this.inited&&this.updateGameConfig()}},methods:{moveOptionIndex(e){const t=this.__setting.list[this.__setting.activedIndex];t&&(t.selectedOptionIndex=ze(t.options,t.selectedOptionIndex+e,-1))},init(){this.__setting.list=[new _e("\u5DE6\u6447\u6746\u64CD\u4F5C\u6E38\u620F\u65B9\u5411","useRockerButtons").setOptions([{name:"\u662F",value:!0},{name:"\u5426",value:!1}]).setValue(this.__gameConfig.useRockerButtons),new _e("\u5DE6\u6447\u6746\u65B9\u5411\u7C7B\u578B","useRockerButtonsType").setOptions([{name:"8\u65B9\u5411",value:8},{name:"4\u65B9\u5411",value:4}]).setValue(this.__gameConfig.useRockerButtonsType),new _e("\u624B\u67C4\u56FE\u6807\u7C7B\u578B","gamepadButtonType").setOptions([{name:"PS",value:"ps"},{name:"Xbox",value:"xbox"},{name:"Switch",value:"switch"}]).setValue(this.__gameConfig.gamepadButtonType)],this.__setting.on("ButtonDown",e=>{switch(e){case"Right":return this.moveOptionIndex(1),!0;case"Left":return this.moveOptionIndex(-1),!0;case"Ok":return this.__setting.activedIndex==-1&&this.resetGameConfig(),!0}}),this.$nextTick(()=>{this.inited=!0})},updateGameConfig(){this.store.gameConfig=this.__settedGameConfig,this.store.saveGameConfigData()},async resetGameConfig(){await this.store.confirm("\u5C06\u6062\u590D\u9ED8\u8BA4\u8BBE\u7F6E\u5E76\u5237\u65B0 , \u662F\u5426\u7EE7\u7EED ?")&&(localStorage.removeItem("GameConfig"),location.reload())},updateSettingItem(e,t){e.selectedOptionIndex=t}},mounted(){this.init()}}),ii={class:"Setting"};function oi(e,t,s,n,i,o){const r=Vue.resolveComponent("SettingItem");return Vue.openBlock(),Vue.createElementBlock("div",ii,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.__setting.list,(u,l)=>(Vue.openBlock(),Vue.createBlock(r,Vue.mergeProps({view:e.__setting,index:l,item:u},{onClickOption:w=>e.updateSettingItem(w.item,w.optionIndex)}),null,16,["onClickOption"]))),256))])}var ri=N(ni,[["render",oi]]);const ui=Vue.defineComponent({setup(){return{store:L()}},props:{buttonName:String,label:String},computed:{__border(){return this.store.gameConfig.gamepadButtonType=="switch"&&(this.buttonName=="L3"||this.buttonName=="R3")},__innerHTML(){return ai[this.store.gameConfig.gamepadButtonType][this.buttonName]||this.buttonName}}}),ai={xbox:{Up:"&#xe7ee;",Down:"&#xe603;",Left:"&#xe604;",Right:"&#xe605;",FN_Up:"Y",FN_Down:"A",FN_Left:"X",FN_Right:"B",Select:"&#xecbb;",Start:"&#xe677;",L1:"LB",R1:"RB",L2:"LT",R2:"RT",L3:"LS",R3:"RS",Home:"&#xe8e8;",ScreenShot:"&#xe6cb;"},ps:{Up:"&#xe7ee;",Down:"&#xe603;",Left:"&#xe604;",Right:"&#xe605;",FN_Up:"&#xe64e;",FN_Down:"&#xe64f;",FN_Left:"&#xe650;",FN_Right:"&#xe651;",Select:"Share",Start:"Options",L1:"L1",R1:"R1",L2:"L2",R2:"R2",L3:"L3",R3:"R3",Home:"&#xe671;",ScreenShot:"&#xe6cb;"},switch:{Up:"&#xe7ee;",Down:"&#xe603;",Left:"&#xe604;",Right:"&#xe605;",FN_Up:"X",FN_Down:"B",FN_Left:"Y",FN_Right:"A",Select:"&#xe669;",Start:"&#xe630;",L1:"L",R1:"R",L2:"ZL",R2:"ZR",L3:"L",R3:"R",Home:"&#xe702;",ScreenShot:"&#xe6cb;"}},li=["data-name","data-border"],ci=["data-name","data-border","innerHTML"];function di(e,t,s,n,i,o){return e.label?(Vue.openBlock(),Vue.createElementBlock("span",{key:0,class:"GamepadButtonIcon","data-name":e.buttonName,"data-border":e.__border},Vue.toDisplayString(e.label),9,li)):(Vue.openBlock(),Vue.createElementBlock("span",{key:1,class:"GamepadButtonIcon","data-name":e.buttonName,"data-border":e.__border,innerHTML:e.__innerHTML},null,8,ci))}var me=N(ui,[["render",di]]);const hi=Vue.defineComponent({setup(){return{keyInputer:Vue.ref(),gamepadController:null,store:L()}},components:{Dialog:le,FocusTarget:X,GamepadButtonIcon:me},props:{item:Object,optionIndex:Number},data(){return{title:"",show:!1,from:null,text:"",keyInputModel:!1}},watch:{item(){this.item!=null&&this.setHotKey(this.item,this.optionIndex)}},methods:{initGamepad(){this.gamepadController=R.create(),this.gamepadController.setRockerButtons(!0,4),this.gamepadController.onButtonDown=this.onGamepadInput},init(){this.initGamepad(),this.store.views.HotkeysInputer.on("ButtonDown",()=>{if(this.keyInputModel)return!0})},keyInputEnd(e){const t=this.text;this.keyInputer.el.blur(),this.title="",this.show=!1,this.keyInputModel=!1,this.text="",this.store.toggleActivedView(null,"back"),setTimeout(()=>{this.$emit("update:item",null),j.resumeAll()}),e!=!1&&(this.optionIndex==-1?this.item.options.push({name:t}):this.item.options[this.optionIndex].name=t,this.$emit("keyInputEnd",t),this.$emit("update:item",null))},onGamepadInput(e){if(!(this.keyInputModel==!1||this.from!="gamepad")){if(this.text!="")switch(e){case"FN_Down":this.keyInputEnd(!0);return;case"FN_Right":this.keyInputEnd(!1);return;case"FN_Left":this.text="";return}this.text=e}},onKeyboardInput(e){if(this.keyInputModel==!1||this.from!="keyboard")return;e.preventDefault();const t=he[e.keyCode];if(this.text!="")switch(t){case"Enter":this.keyInputEnd(!0);return;case"Esc":this.keyInputEnd(!1);return;case"Backspace":this.text="";return}this.text=t},setHotKey(e,t){this.show=!0,this.title=(t==-1?"\u6DFB\u52A0\u6309\u952E : ":"\u4FEE\u6539\u6309\u952E : ")+e.name,this.text=t==-1?"":e.options[t].name,this.from=e.type,this.keyInputModel=!0,this.$nextTick(()=>{this.keyInputer.el.focus()}),j.pauseAll()}},unmounted(){R.destroy(this.gamepadController)},mounted(){this.init()}}),mi={style:{width:"300px"}},pi={style:{height:"90px"}},fi={key:0},gi=Vue.createTextVNode(" \u6309\u952E\u76D8 [Backspace] \u6E05\u7A7A , "),vi=Vue.createElementVNode("br",null,null,-1),_i=Vue.createTextVNode(" \u6309\u952E\u76D8 [Esc] \u952E\u53D6\u6D88\u5E76\u8FD4\u56DE , "),Ei=Vue.createElementVNode("br",null,null,-1),wi=Vue.createTextVNode(" \u6309\u952E\u76D8 [Enter] \u952E\u786E\u8BA4\u5E76\u8FD4\u56DE "),Ci=Vue.createElementVNode("br",null,null,-1),Di=Vue.createTextVNode(" \u73B0\u5728\u53EF\u4EE5\u8F93\u5165 "),Vi={key:1},Fi=Vue.createTextVNode(" \u6309\u624B\u67C4 ["),Si=Vue.createTextVNode("] \u6E05\u7A7A , "),ki=Vue.createElementVNode("br",null,null,-1),yi=Vue.createTextVNode(" \u6309\u624B\u67C4 ["),Ai=Vue.createTextVNode("] \u952E\u53D6\u6D88\u5E76\u8FD4\u56DE , "),Bi=Vue.createElementVNode("br",null,null,-1),Ri=Vue.createTextVNode(" \u6309\u624B\u67C4 ["),Ti=Vue.createTextVNode("] \u952E\u786E\u8BA4\u5E76\u8FD4\u56DE "),Ni=Vue.createElementVNode("br",null,null,-1),Oi=Vue.createTextVNode(" \u73B0\u5728\u53EF\u4EE5\u8F93\u5165 "),$i=Vue.createTextVNode("[ "),Li=Vue.createTextVNode(" \u6309\u4EFB\u610F\u952E "),bi=Vue.createTextVNode(" ]");function Ii(e,t,s,n,i,o){const r=Vue.resolveComponent("GamepadButtonIcon"),u=Vue.resolveComponent("FocusTarget"),l=Vue.resolveComponent("Dialog");return Vue.withDirectives((Vue.openBlock(),Vue.createBlock(l,{title:e.title,onClickOverlay:t[0]||(t[0]=w=>e.keyInputEnd(!1))},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",mi,[Vue.createElementVNode("div",pi,[e.from=="keyboard"?(Vue.openBlock(),Vue.createElementBlock("p",fi,[e.text?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:0},[gi,vi,_i,Ei,wi,Ci],64)):(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:1},[Di],64))])):(Vue.openBlock(),Vue.createElementBlock("p",Vi,[e.text?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:0},[Fi,Vue.createVNode(r,{"button-name":"FN_Left"}),Si,ki,yi,Vue.createVNode(r,{"button-name":"FN_Right"}),Ai,Bi,Ri,Vue.createVNode(r,{"button-name":"FN_Down"}),Ti,Ni],64)):(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:1},[Oi],64))]))]),Vue.createVNode(u,{"tag-name":"button",class:"keyInputer",ref:"keyInputer",tabindex:"-1",view:e.store.views.HotkeysInputer,onKeydown:e.onKeyboardInput},{default:Vue.withCtx(()=>[$i,e.text?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:0},[e.item.type=="keyboard"?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:0},[Vue.createTextVNode(Vue.toDisplayString(e.text),1)],64)):(Vue.openBlock(),Vue.createBlock(r,{key:1,"button-name":e.text},null,8,["button-name"]))],64)):(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:1},[Li],64)),bi]),_:1},8,["view","onKeydown"])])]),_:1},8,["title"])),[[Vue.vShow,e.show]])}var Mt=N(hi,[["render",Ii]]);const xi=Vue.defineComponent({setup(){return{fouseTargetElement:null,store:L()}},components:{Dialog:le,SettingItem:xt,FocusTarget:X,HotkeysInputer:Mt,GamepadButtonIcon:me},props:{type:String},data(){return{keyInputOldText:"",keyInputTargetItem:null,keyInputOptionIndex:0}},computed:{__hotkey(){return this.type=="gamepad"?this.store.views.Hotkeys_Gamepad:this.store.views.Hotkeys_Keyboard}},methods:{async resetHotkey(){await this.store.confirm("\u5C06\u6062\u590D\u9ED8\u8BA4\u6309\u952E\u7ED1\u5B9A\u5E76\u5237\u65B0 , \u662F\u5426\u7EE7\u7EED ?")&&(localStorage.removeItem("GameControllerBindingDatas"),location.reload())},initList(){const e=this.store.gameControllerBindDatas.menus,t=this.store.gameControllerBindDatas.gameing,s=this.store.gameControllerBindDatas.time;this.type=="gamepad"?this.__hotkey.list=[new _("gamepad","\u83DC\u5355\u754C\u9762 - \u6E38\u620F\u624B\u67C4"),new _("gamepad","\u663E\u793A/\u9690\u85CF\u83DC\u5355",e.gamepad,"ShowMenu"),new _("gamepad","\u9009\u9879",e.gamepad,"Options"),new _("gamepad","\u786E\u5B9A",e.gamepad,"Ok"),new _("gamepad","\u53D6\u6D88/\u8FD4\u56DE",e.gamepad,"Cancel"),new _("gamepad","\u4E0A",e.gamepad,"Up"),new _("gamepad","\u4E0B",e.gamepad,"Down"),new _("gamepad","\u5DE6",e.gamepad,"Left"),new _("gamepad","\u53F3",e.gamepad,"Right"),new _("gamepad","\u6E38\u620F\u65F6 - \u624B\u67C4"),new _("gamepad","\u4E0A",t.gamepad,"Up"),new _("gamepad","\u4E0B",t.gamepad,"Down"),new _("gamepad","\u5DE6",t.gamepad,"Left"),new _("gamepad","\u53F3",t.gamepad,"Right"),new _("gamepad","\u9009\u62E9",t.gamepad,"Select"),new _("gamepad","\u5F00\u59CB",t.gamepad,"Start"),new _("gamepad","\u653B\u51FB",t.gamepad,"Fire"),new _("gamepad","\u653B\u51FB(\u8FDE\u53D1)",t.gamepad,"AutoFire"),new _("gamepad","\u8DF3\u8DC3",t.gamepad,"Jump"),new _("gamepad","\u8DF3\u8DC3(\u8FDE\u53D1)",t.gamepad,"AutoJump"),new _("gamepad","\u65F6\u95F4\u63A7\u5236 - \u624B\u67C4"),new _("gamepad","\u5B58\u6863/\u65F6\u95F4\u5012\u6D41",s.gamepad,"Save"),new _("gamepad","\u8BFB\u6863/\u65F6\u95F4\u987A\u6D41",s.gamepad,"Load"),new _("gamepad","\u65F6\u95F4\u63A7\u5236",s.gamepad,"Time"),new _("gamepad","\u65F6\u95F4\u51CF\u901F",s.gamepad,"Slow"),new _("gamepad","\u5DE6",s.gamepad,"Left"),new _("gamepad","\u53F3",s.gamepad,"Right"),new _("gamepad","\u4E0B",s.gamepad,"Down")]:this.__hotkey.list=[new _("keyboard","\u83DC\u5355\u754C\u9762 - \u952E\u76D8"),new _("keyboard","\u663E\u793A/\u9690\u85CF\u83DC\u5355",e.keyboard,"ShowMenu"),new _("keyboard","\u9009\u9879",e.keyboard,"Options"),new _("keyboard","\u786E\u5B9A",e.keyboard,"Ok"),new _("keyboard","\u53D6\u6D88/\u8FD4\u56DE",e.keyboard,"Cancel"),new _("keyboard","\u4E0A",e.keyboard,"Up"),new _("keyboard","\u4E0B",e.keyboard,"Down"),new _("keyboard","\u5DE6",e.keyboard,"Left"),new _("keyboard","\u53F3",e.keyboard,"Right"),new _("keyboard","\u6E38\u620F\u65F6 - \u952E\u76D8"),new _("keyboard","\u4E0A",t.keyboard,"Up"),new _("keyboard","\u4E0B",t.keyboard,"Down"),new _("keyboard","\u5DE6",t.keyboard,"Left"),new _("keyboard","\u53F3",t.keyboard,"Right"),new _("keyboard","\u9009\u62E9",t.keyboard,"Select"),new _("keyboard","\u5F00\u59CB",t.keyboard,"Start"),new _("keyboard","\u653B\u51FB",t.keyboard,"Fire"),new _("keyboard","\u653B\u51FB(\u8FDE\u53D1)",t.keyboard,"AutoFire"),new _("keyboard","\u8DF3\u8DC3",t.keyboard,"Jump"),new _("keyboard","\u8DF3\u8DC3(\u8FDE\u53D1)",t.keyboard,"AutoJump"),new _("keyboard","\u65F6\u95F4\u63A7\u5236 - \u952E\u76D8"),new _("keyboard","\u5B58\u6863/\u65F6\u95F4\u5012\u6D41",s.keyboard,"Save"),new _("keyboard","\u8BFB\u6863/\u65F6\u95F4\u987A\u6D41",s.keyboard,"Load"),new _("keyboard","\u65F6\u95F4\u63A7\u5236",s.keyboard,"Time"),new _("keyboard","\u65F6\u95F4\u51CF\u901F",s.keyboard,"Slow"),new _("keyboard","\u5DE6",s.keyboard,"Left"),new _("keyboard","\u53F3",s.keyboard,"Right"),new _("keyboard","\u4E0B",s.keyboard,"Down")]},moveOptionIndex(e){const t=this.__hotkey.list[this.__hotkey.activedIndex];t&&(t.selectedOptionIndex=ze(t.options,t.selectedOptionIndex+e,-1))},init(){this.initList(),this.__hotkey.activedIndex=1,this.__hotkey.on("ButtonDown",e=>{switch(e){case"Right":return this.moveOptionIndex(1),!0;case"Left":return this.moveOptionIndex(-1),!0;case"Ok":if(this.__hotkey.activedIndex==-1)return this.resetHotkey(),!0;const t=this.__hotkey.list[this.__hotkey.activedIndex];return t.selectedOptionIndex==-1?this.setHotKey(t,-1):this.setHotKey(t,t.selectedOptionIndex),!0}}),this.__hotkey.on("Option",e=>{const t=this.__hotkey.list[this.__hotkey.activedIndex];if(e.value=="SetHotkey"){this.setHotKey(t,t.selectedOptionIndex);return}if(e.value=="RemoveHotkey"){if(t.options.length<=1){this.store.alert("\u5FC5\u987B\u4FDD\u7559\u81F3\u5C111\u4E2A\u6309\u952E !");return}t.options.splice(t.selectedOptionIndex,1),t.options.length-1<t.selectedOptionIndex&&t.selectedOptionIndex--,this.keyInputOldText="",this.updateHotkey(t,"")}})},updateHotkey(e,t){if(t!=""&&this.keyInputOldText==t)return;const s=e.from;if(this.keyInputOldText==""){const n=e.options[e.options.length-1].name;if(e.options.filter(i=>i.name=n).length>1){this.store.alert("\u91CD\u590D\u7684\u6309\u952E !"),e.options.pop();return}s[e.key]=e.options.map(i=>i.name)}else{let n=null;for(let i in s)if(s[i].includes(t)){n=i;break}if(n){const i=s[n],o=i.indexOf(t),r=this.__hotkey.list.find(u=>u.from==s&&u.key==n);i[o]=this.keyInputOldText,r.options[o].name=this.keyInputOldText}s[e.key][e.selectedOptionIndex]=t}j.updateBindingData(),this.store.saveHotkeyData()},setHotKey(e,t){if(e.type=="gamepad"&&this.store.gamepadConnected==!1){this.store.alert("\u9700\u8981\u8FDE\u63A5\u624B\u67C4\u540E\u624D\u53EF\u4EE5\u64CD\u4F5C !");return}this.keyInputOldText=t==-1?"":e.options[t].name,this.keyInputOptionIndex=t,this.keyInputTargetItem=e,this.$nextTick(()=>{this.store.toggleActivedView("HotkeysInputer")})}},mounted(){this.init()}}),Mi={class:"Hotkeys"},Ui=["data-selected","onClick","onContextmenu"],Pi=Vue.createTextVNode("[ "),Hi=Vue.createTextVNode(" ]"),Gi=["data-selected","onClick"],ji=Vue.createTextVNode("\u6062\u590D\u4E3A\u9ED8\u8BA4\u6309\u952E");function zi(e,t,s,n,i,o){const r=Vue.resolveComponent("GamepadButtonIcon"),u=Vue.resolveComponent("SettingItem"),l=Vue.resolveComponent("FocusTarget"),w=Vue.resolveComponent("HotkeysInputer");return Vue.openBlock(),Vue.createElementBlock("div",Mi,[Vue.createElementVNode("div",null,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.__hotkey.list,(h,C)=>(Vue.openBlock(),Vue.createBlock(u,Vue.normalizeProps(Vue.guardReactiveProps({view:e.__hotkey,index:C,item:h})),{option:Vue.withCtx(({option:S,optionIndex:V})=>[Vue.createElementVNode("div",{class:"Setting-item-option",style:{"font-size":"12px"},"data-selected":h.selectedOptionIndex==V,onClick:O=>{h.selectedOptionIndex=V,e.setHotKey(h,V)},onContextmenu:Vue.withModifiers(O=>h.selectedOptionIndex=V,["prevent"])},[Pi,h.type=="keyboard"?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:0},[Vue.createTextVNode(Vue.toDisplayString(S.name),1)],64)):(Vue.openBlock(),Vue.createBlock(r,{key:1,"button-name":S.name},null,8,["button-name"])),Hi],40,Ui)]),otherOption:Vue.withCtx(()=>[Vue.createElementVNode("div",{class:"Setting-item-option","data-selected":h.selectedOptionIndex==-1,onClick:S=>e.setHotKey(h,-1)},"\u6DFB\u52A0",8,Gi)]),_:2},1040))),256))]),Vue.createVNode(l,{style:{height:"40px",width:"60%",margin:"8px auto",display:"block"},"tag-name":"button",view:e.__hotkey,index:-1,onClick:e.resetHotkey},{default:Vue.withCtx(()=>[ji]),_:1},8,["view","onClick"]),Vue.createVNode(w,{item:e.keyInputTargetItem,"onUpdate:item":t[0]||(t[0]=h=>e.keyInputTargetItem=h),optionIndex:e.keyInputOptionIndex,onKeyInputEnd:t[1]||(t[1]=h=>e.updateHotkey(e.keyInputTargetItem,h))},null,8,["item","optionIndex"])])}var qi=N(xi,[["render",zi]]);const Ji=Vue.defineComponent({setup(){return{store:L(),menusController:null}},components:{FocusTarget:X,Dialog:le},computed:{__activedView(){return this.store.views[this.store.activedView]}}}),Wi={class:"MenuOptions"};function Xi(e,t,s,n,i,o){const r=Vue.resolveComponent("FocusTarget"),u=Vue.resolveComponent("Dialog");return e.__activedView.isOptionsView?(Vue.openBlock(),Vue.createBlock(u,{key:0,class:"MenuOptions-dialog",onClickOverlay:e.store.buttonDown_Cancel},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",Wi,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.__activedView.list,(l,w)=>(Vue.openBlock(),Vue.createBlock(r,{class:"MenuOption",view:e.__activedView,index:w,onClick:t[0]||(t[0]=h=>e.store.buttonDown_Ok())},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(l.name),1)]),_:2},1032,["view","index"]))),256))])]),_:1},8,["onClickOverlay"])):Vue.createCommentVNode("",!0)}var Yi=N(Ji,[["render",Xi]]);const Zi=Vue.defineComponent({setup(){return{store:L()}},components:{Dialog:le,FocusTarget:X},computed:{__alert(){return this.store.views.Alert}},methods:{init(){this.__alert.on("ButtonDown",e=>{switch(e){case"Cancel":case"Ok":this.store.toggleActivedView(null,"back")}return!0})}},mounted(){this.init()}}),Qi={class:"Alert flex top acenter"},Ki={class:"flex-item expand"},eo=Vue.createTextVNode("\u786E\u8BA4");function to(e,t,s,n,i,o){const r=Vue.resolveComponent("FocusTarget"),u=Vue.resolveComponent("Dialog");return Vue.withDirectives((Vue.openBlock(),Vue.createBlock(u,{class:"Alert-dialog",title:"\u63D0\u793A",onClickOverlay:t[1]||(t[1]=l=>e.store.toggleActivedView(null,"back"))},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",Qi,[Vue.createElementVNode("pre",Ki,Vue.toDisplayString(e.__alert.message),1),Vue.createVNode(r,{"tag-name":"Button",class:"Alert-button",view:e.__alert,index:0,onClick:t[0]||(t[0]=l=>e.store.buttonDown_Ok())},{default:Vue.withCtx(()=>[eo]),_:1},8,["view"])])]),_:1},512)),[[Vue.vShow,e.__alert.actived]])}var so=N(Zi,[["render",to]]);const no=Vue.defineComponent({setup(){return{store:L()}},components:{Dialog:le,FocusTarget:X},computed:{__confirm(){return this.store.views.Confirm}},methods:{runOption(e){console.log(e)},init(){this.__confirm.on("ButtonDown",e=>{switch(e){case"Cancel":return this.store.toggleActivedView(null,"back"),this.__confirm.callback(this.__confirm.list[0].value),!0;case"Ok":return this.store.toggleActivedView(null,"back"),this.__confirm.callback(this.__confirm.list[this.__confirm.activedIndex].value),!0;case"ShowMenu":return!0}})}},mounted(){this.init()}}),io={class:"Confirm flex top acenter"},oo={class:"flex-item expand"},ro={class:"flex-item flex center"};function uo(e,t,s,n,i,o){const r=Vue.resolveComponent("FocusTarget"),u=Vue.resolveComponent("Dialog");return Vue.withDirectives((Vue.openBlock(),Vue.createBlock(u,{class:"Confirm-dialog",title:"\u63D0\u793A",onClickOverlay:t[0]||(t[0]=l=>e.store.toggleActivedView(null,"back"))},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",io,[Vue.createElementVNode("pre",oo,Vue.toDisplayString(e.__confirm.message),1),Vue.createElementVNode("div",ro,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.__confirm.list,(l,w)=>(Vue.openBlock(),Vue.createBlock(r,{"tag-name":"Button",class:"Confirm-button",view:e.__confirm,index:w,onClick:h=>e.runOption(l)},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(l.name),1)]),_:2},1032,["view","index","onClick"]))),256))])])]),_:1},512)),[[Vue.vShow,e.__confirm.actived]])}var ao=N(no,[["render",uo]]);const lo=Vue.defineComponent({components:{FocusTarget:X},setup(){return{store:L()}},data(){return{inited:!1}},computed:{__help(){return this.store.views.Help}},methods:{init(){this.__help.list=["1. \u6E38\u620F\u8D44\u6E90","\u6E38\u620F\u8D44\u6E90\u9700\u8981\u81EA\u5DF1\u4ECE\u7F51\u4E0A\u4E0B\u8F7D , \u4F60\u53EF\u4EE5\u4ECE\u767E\u5EA6\u6216\u8005\u5176\u4ED6\u8D44\u6E90\u7AD9\u4E0B\u8F7D\u5230 .nes \u540E\u7F00\u7684\u6E38\u620F\u6587\u4EF6\u6765\u5BFC\u5165\u6765\u73A9 , \u6BD4\u5982 (oldmanemu.net)","\u56E0\u4E3A jsnes \u8FD9\u4E2A\u5F00\u6E90\u9879\u76EE\u5DF2\u7ECF\u505C\u6B62\u66F4\u65B0\u4E86 , \u6240\u4EE5\u8FD9\u4E2A\u6A21\u62DF\u5668\u5E76\u4E0D\u80FD\u5B8C\u7F8E\u8FD0\u884C\u6240\u6709\u6E38\u620F , \u5C24\u5176\u662F\u5404\u79CD\u9B54\u6539\u7248\u548C\u6C49\u5316\u7248 , \u539F\u7248\u6E38\u620F\u7684\u517C\u5BB9\u6027\u8FD8\u7B97ok , \u5E38\u89C1\u6E38\u620F\u90FD\u80FD\u73A9",`
`,`
`,"2. \u64CD\u4F5C\u65B9\u5F0F","\u652F\u6301\u7EAF\u952E\u76D8/\u7EAF\u6E38\u620F\u624B\u67C4/\u89E6\u6478\u5C4F\u64CD\u4F5C(\u665A\u4E24\u5929\u66F4\u65B0)\u6765\u64CD\u4F5C\u6A21\u62DF\u5668\u548C\u6E38\u620F , \u5F3A\u70C8\u63A8\u8350\u4F7F\u7528\u624B\u67C4! ",`
`,"2.1 \u4F7F\u7528\u952E\u76D8\u64CD\u4F5C",`wasd \u6216 \u4E0A\u4E0B\u5DE6\u53F3 \u6765\u63A7\u5236\u5149\u6807\u79FB\u52A8 , 
\u56DE\u8F66\u952E(Enter) \u786E\u5B9A , 
\u5220\u9664\u952E(Backspace) \u8FD4\u56DE , 
Esc\u6216Esc\u4E0B\u9762\u7684\u6CE2\u6D6A\u53F7\u952E\u6765\u547C\u51FA/\u9690\u85CF\u6E38\u620F\u83DC\u5355 , 
Alt \u952E\u53EF\u4EE5\u6253\u5F00\u67D0\u4E9B\u83DC\u5355\u754C\u9762\u7684\u529F\u80FD\u9009\u9879`,`wasd \u6216 \u4E0A\u4E0B\u5DE6\u53F3 \u6765\u63A7\u5236\u6E38\u620F\u65B9\u5411 , 
\u56DE\u8F66\u952E(Enter) \u5F00\u59CB\u6E38\u620F(Start\u7684\u529F\u80FD) , 
Tab \u952E\u9009\u62E9\u6E38\u620F\u9009\u9879(Select\u7684\u529F\u80FD) , 
x/j \u653B\u51FB , 
c/k \u8DF3\u8DC3 , 
z/u \u53EF\u4EE5\u8FDE\u53D1\u653B\u51FB , \u4E0D\u987A\u624B\u7684\u8BDD , \u4E5F\u53EF\u4EE5\u5728\u8BBE\u7F6E\u754C\u9762\u81EA\u5DF1\u4FEE\u6539 `,`\u6570\u5B571 \u5373\u65F6\u5B58\u6863 , 
\u6570\u5B572 \u5373\u65F6\u8BFB\u6863 , \u957F\u6309\u8FD8\u53EF\u4EE5\u8BFB\u53D6\u4E0A\u4E00\u6B21\u7684\u5B58\u6863 , 
\u7A7A\u683C(Space)\u6216\u8005Alt\u53EF\u4EE5\u6682\u505C\u5E76\u8FDB\u5165\u65F6\u95F4\u63A7\u5236\u6A21\u5F0F(\u65F6\u95F4\u63A7\u5236\u6A21\u5F0F\u4E0B , \u6309\u5DE6/\u53F3\u53EF\u4EE5\u81EA\u7531\u63A7\u5236\u65F6\u95F4\u6D41\u52A8\u548C\u901F\u5EA6 , \u518D\u6309\u9000\u51FA , \u5E76\u4ECE\u9009\u62E9\u7684\u65F6\u95F4\u70B9\u7EE7\u7EED\u6E38\u620F) , \u957F\u6309\u53EF\u4EE5\u76F4\u63A5\u65F6\u95F4\u5012\u6D41 , \u677E\u5F00\u540E\u6062\u590D , 
Ctrl\u53EF\u4EE5\u4F7F\u65F6\u95F4\u53D8\u6162 , \u53CC\u51FB\u8FD8\u53EF\u4EE5\u66F4\u6162
Ctrl\u6309\u4E0B\u540E\u4E0D\u653E , \u5728\u6309\u65F6\u95F4\u63A7\u5236\u952E(\u7A7A\u683C/Alt)\u8FD8\u53EF\u4EE5\u6E38\u620F\u52A0\u901F\u6765\u8DF3\u8FC7\u8FC7\u573A\u52A8\u753B`,`
`,"2.2 \u4F7F\u7528\u624B\u67C4\u64CD\u4F5C(\u4EE5PS\u624B\u67C4\u4E3A\u4F8B)",`\u65B9\u5411\u952E\u6216\u5DE6\u6447\u6746 \u6765\u63A7\u5236\u5149\u6807\u79FB\u52A8 , 
X\u952E \u786E\u5B9A , 
\u5706\u5708\u952E \u8FD4\u56DE , 
Ps\u952E\u6765\u547C\u51FA/\u9690\u85CF\u6E38\u620F\u83DC\u5355 , 
Options\u952E \u53EF\u4EE5\u6253\u5F00\u67D0\u4E9B\u83DC\u5355\u754C\u9762\u7684\u529F\u80FD\u9009\u9879`,`\u65B9\u5411\u952E\u6216\u5DE6\u6447\u6746 \u6765\u63A7\u5236\u6E38\u620F\u65B9\u5411 , 
Options\u952E \u5F00\u59CB\u6E38\u620F(Start\u7684\u529F\u80FD) , 
Share \u952E\u9009\u62E9\u6E38\u620F\u9009\u9879(Select\u7684\u529F\u80FD) , 
\u65B9\u5757 \u653B\u51FB , 
X \u8DF3\u8DC3 , 
\u4E09\u89D2 \u53EF\u4EE5\u8FDE\u53D1\u653B\u51FB , \u4E0D\u987A\u624B\u7684\u8BDD , \u4E5F\u53EF\u4EE5\u5728\u8BBE\u7F6E\u754C\u9762\u81EA\u5DF1\u4FEE\u6539 `,`L1 \u5373\u65F6\u5B58\u6863 , 
R1 \u5373\u65F6\u8BFB\u6863 , \u957F\u6309\u8FD8\u53EF\u4EE5\u8BFB\u53D6\u4E0A\u4E00\u6B21\u7684\u5B58\u6863 , 
L2 \u53EF\u4EE5\u6682\u505C\u5E76\u8FDB\u5165\u65F6\u95F4\u63A7\u5236\u6A21\u5F0F(\u65F6\u95F4\u63A7\u5236\u6A21\u5F0F\u4E0B , \u6309\u5DE6/\u53F3\u6216\u8005L1/R1\u53EF\u4EE5\u81EA\u7531\u63A7\u5236\u65F6\u95F4\u6D41\u52A8\u548C\u901F\u5EA6 , \u518D\u6309\u9000\u51FA , \u5E76\u4ECE\u9009\u62E9\u7684\u65F6\u95F4\u70B9\u7EE7\u7EED\u6E38\u620F) , \u957F\u6309\u53EF\u4EE5\u76F4\u63A5\u65F6\u95F4\u5012\u6D41 , \u677E\u5F00\u540E\u6062\u590D , 
R2\u53EF\u4EE5\u4F7F\u65F6\u95F4\u53D8\u6162 , \u53CC\u51FB\u8FD8\u53EF\u4EE5\u66F4\u6162
R2\u6309\u4E0B\u540E\u4E0D\u653E , \u5728\u6309\u65F6\u95F4\u63A7\u5236\u952E(L2)\u8FD8\u53EF\u4EE5\u6E38\u620F\u52A0\u901F\u6765\u8DF3\u8FC7\u8FC7\u573A\u52A8\u753B`,`
`,`
`,"",`
`,""].map(e=>new J(e)),this.__help.on("ButtonDown",e=>{switch(e){case"Ok":return this.store.toggleActivedView(null,"back"),!0}})}},mounted(){this.init()}}),co={class:"Help"},ho=Vue.createTextVNode("            "),mo=Vue.createTextVNode(`
        `);function po(e,t,s,n,i,o){const r=Vue.resolveComponent("FocusTarget");return Vue.openBlock(),Vue.createElementBlock("div",co,[Vue.createElementVNode("pre",null,[ho,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.__help.list,(u,l)=>(Vue.openBlock(),Vue.createBlock(r,{"tag-name":"p",view:e.__help,index:l},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(u.name),1)]),_:2},1032,["view","index"]))),256)),mo])])}var fo=N(lo,[["render",po]]);const go=Vue.defineComponent({setup(){return{store:L(),uiController:null}},components:{FocusTarget:X,Dialog:le,Games:Xn,Setting:ri,Hotkeys:qi,HotkeysInputer:Mt,OptionsView:Yi,GamepadButtonIcon:me,Focused:xn,Alert:so,Confirm:ao,Help:fo},computed:{__activedView(){return this.store.views[this.store.activedView]},__menus(){return this.store.views.Menus},__activedMenu(){return this.__menus.list[this.__menus.activedIndex]}},watch:{"store.selectedGame"(){this.store.showMenu=!1}},methods:{initMenusController(){this.uiController=new j("menus",En),this.uiController.bindGamepad(this.store.gameControllerBindDatas.menus.gamepad),this.uiController.bindKeyBoard(this.store.gameControllerBindDatas.menus.keyboard),this.uiController.initKeyboard(),this.uiController.initGamePad(),this.uiController.setAutoPressButtons(["Up","Down","Left","Right"]),this.uiController.gamepadController.setRockerButtons(!0,4),R.on("gamepadconnected",()=>{this.store.gamepadConnected=!0}),R.on("gamepaddisconnected",()=>{this.store.gamepadConnected=!1}),this.uiController.onButtonDown=e=>{if(!(this.store.showMenu==!1&&e!="ShowMenu"))switch(e){case"ShowMenu":this.store.buttonDown_ShowMenu();break;case"Up":case"Down":case"Left":case"Right":this.store.buttonDown_Direction(e);break;case"Cancel":this.store.buttonDown_Cancel();break;case"Ok":this.store.buttonDown_Ok();break;case"Options":this.store.buttonDown_Options();break}}},screenshot(){this.$emit("screenshot")},toggleFullScene(){document.fullscreenElement?document.exitFullscreen():document.querySelector("#app").requestFullscreen()},init(){this.__menus.on("ButtonDown",e=>{switch(e){case"Cancel":return this.store.showMenu=!1,!0;case"Right":return this.__activedMenu.viewName!="CloseMenu"&&this.__activedMenu.viewName!="ToggleFullScene"&&this.__activedMenu.viewName!="Screenshot"?this.store.buttonDown_Ok():this.__activedMenu.viewName=="Screenshot"&&this.store.toggleActivedView("Games"),!0;case"Ok":if(this.__activedMenu.viewName=="CloseMenu")return this.store.showMenu=!1,!0;if(this.__activedMenu.viewName=="ToggleFullScene")return this.toggleFullScene(),!0;if(this.__activedMenu.viewName=="Screenshot")return this.screenshot(),!0}})}},beforeUnmount(){this.uiController.destroy()},async mounted(){this.init(),this.initMenusController()}}),vo={class:"Ui"},_o={class:"Menu flex"},Eo={class:"Menu-buttons flex-item"},wo={class:"flex-item expand"};function Co(e,t,s,n,i,o){const r=Vue.resolveComponent("FocusTarget"),u=Vue.resolveComponent("Games"),l=Vue.resolveComponent("Setting"),w=Vue.resolveComponent("Hotkeys"),h=Vue.resolveComponent("Help"),C=Vue.resolveComponent("Dialog"),S=Vue.resolveComponent("HotkeysInputer"),V=Vue.resolveComponent("OptionsView"),O=Vue.resolveComponent("Alert"),U=Vue.resolveComponent("Confirm"),P=Vue.resolveComponent("Focused");return Vue.openBlock(),Vue.createElementBlock("div",vo,[Vue.withDirectives(Vue.createVNode(C,null,{default:Vue.withCtx(()=>[Vue.createElementVNode("div",_o,[Vue.createElementVNode("div",Eo,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.__menus.list,(B,b)=>(Vue.openBlock(),Vue.createBlock(r,{"tag-name":"button",class:"Menu-button",view:e.__menus,index:b,onClick:e.store.buttonDown_Ok},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(B.name),1)]),_:2},1032,["view","index","onClick"]))),256))]),Vue.createElementVNode("div",wo,[Vue.withDirectives(Vue.createVNode(u,{class:"Menu-content"},null,512),[[Vue.vShow,e.__activedMenu.viewName=="Games"||e.__activedMenu.viewName=="Screenshot"]]),Vue.withDirectives(Vue.createVNode(l,{class:"Menu-content"},null,512),[[Vue.vShow,e.__activedMenu.viewName=="Setting"]]),Vue.withDirectives(Vue.createVNode(w,{class:"Menu-content",type:"gamepad"},null,512),[[Vue.vShow,e.__activedMenu.viewName=="Hotkeys_Gamepad"]]),Vue.withDirectives(Vue.createVNode(w,{class:"Menu-content",type:"keyboard"},null,512),[[Vue.vShow,e.__activedMenu.viewName=="Hotkeys_Keyboard"]]),Vue.withDirectives(Vue.createVNode(h,{class:"Menu-content"},null,512),[[Vue.vShow,e.__activedMenu.viewName=="Help"]])])])]),_:1},512),[[Vue.vShow,e.store.showMenu]]),Vue.createVNode(S),Vue.createVNode(V),Vue.createVNode(O),Vue.createVNode(U),Vue.createVNode(P)])}var Do=N(go,[["render",Co]]);const Vo=Vue.defineComponent({components:{GamepadButtonIcon:me},setup(){return{el:Vue.ref(),position:new x(0,0)}},props:{buttons:Array,buttonsActivedStatus:Array,radius:{type:Number,default:60}},data(){return{touched:!1,targetPosition:new x(0,0),inited:!1}},computed:{__targetStyle(){return{transform:`translate(-50%,50%) translate(${this.targetPosition.x}px , ${-this.targetPosition.y}px)`}}},methods:{init(){window.addEventListener("resize",this.updatePosition),this.$nextTick(this.updatePosition)},updatePosition(){const e=this.el.getBoundingClientRect();this.position.y=e.top+e.height/2,this.position.x=e.left+e.width/2},getButtonStyle(e){const t=x.angleToPosttion(e/this.buttons.length*360).mul(50);return{transform:`translate(-50%,50%) translate(${t.x}px , ${-t.y}px)`}},updateTargetByRockerData(e,t,s=1){const n=Math.sqrt(e*e+t*t);n>s&&(e/=n/s,t/=n/s),e*=this.radius/s,t*=this.radius/s,this.targetPosition.x=e,this.targetPosition.y=t},onTouchEnd(e){Array.from(e.touches).find(s=>s.target==this.el)||(this.touched=!1,this.targetPosition.x=0,this.targetPosition.y=0,this.$emit("update:position",this.targetPosition))},onTouchMove(e){const t=Array.from(e.touches).find(s=>s.target==this.el);if(t){const s=t.clientX-this.position.x,n=-(t.clientY-this.position.y);this.updateTargetByRockerData(s,n,this.radius),this.$emit("update:position",this.targetPosition)}},onTouchStart(e){this.touched=!0,this.onTouchMove(e)}},unmounted(){window.removeEventListener("resize",this.updatePosition)},mounted(){this.init()}}),Fo=["data-touched"],So={class:"TouchControllerRocker-buttons"};function ko(e,t,s,n,i,o){const r=Vue.resolveComponent("GamepadButtonIcon");return Vue.openBlock(),Vue.createElementBlock("div",{ref:"el",class:"TouchControllerRocker","data-touched":e.touched,onTouchstart:t[0]||(t[0]=Vue.withModifiers((...u)=>e.onTouchStart&&e.onTouchStart(...u),["prevent"])),onTouchmove:t[1]||(t[1]=Vue.withModifiers((...u)=>e.onTouchMove&&e.onTouchMove(...u),["prevent"])),onTouchend:t[2]||(t[2]=(...u)=>e.onTouchEnd&&e.onTouchEnd(...u)),onTouchcancel:t[3]||(t[3]=(...u)=>e.onTouchEnd&&e.onTouchEnd(...u))},[Vue.createElementVNode("div",So,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.buttons,(u,l)=>(Vue.openBlock(),Vue.createBlock(r,{class:"TouchControllerRocker-button","button-name":u,style:Vue.normalizeStyle(e.getButtonStyle(l)),"data-actived":e.buttonsActivedStatus[l]},null,8,["button-name","style","data-actived"]))),256))]),Vue.createElementVNode("div",{class:"TouchControllerRocker-target",style:Vue.normalizeStyle(e.__targetStyle)},null,4)],40,Fo)}var yo=N(Vo,[["render",ko]]);const Ao=Vue.defineComponent({components:{TouchControllerRocker:yo,GamepadButtonIcon:me},setup(){return{store:L(),gamepadColtroller:null}},data(){return{L_RockerButtonsActivedStatus:[!1,!1,!1,!1],R_RockerButtonsActivedStatus:[!1,!1,!1,!1],button_Select_isDown:!1,button_Start_isDown:!1,menuButtons:[{name:"Home",isDown:!1,label:""},{name:"L1",isDown:!1,label:"\u5B58\u6863"},{name:"R1",isDown:!1,label:"\u8BFB\u6863"},{name:"L2",isDown:!1,label:"\u65F6\u95F4"},{name:"R2",isDown:!1,label:"\u51CF\u901F"},{name:"Select",isDown:!1,label:"\u9009\u62E9"},{name:"Start",isDown:!1,label:"\u5F00\u59CB"}],isTouchDevice:!1}},methods:{init(){/(Android|iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)&&(this.isTouchDevice=!0,this.$nextTick(this.initGamepadControll),R.on("gamepadconnected",()=>{this.isTouchDevice=!1,this.gamepadColtroller.setRockerButtons(this.store.gameConfig.useRockerButtons,this.store.gameConfig.useRockerButtonsType),this.gamepadColtroller.set_R_RockerButtons(!1,8),this.gamepadColtroller.onStatusChange=null,this.gamepadColtroller.onlyRockerButtons=!1}),R.on("gamepaddisconnected",()=>{this.isTouchDevice=!0,this.$nextTick(this.initGamepadControll)}))},updateButtonStatus(e,t){this.gamepadColtroller.updateStatus(e.name,t),e.isDown=this.gamepadColtroller.status[e.name],this.$emit("update:button",e)},updateRockerStatus(e,t){this.gamepadColtroller.updateRockerStatus(e,t),this.gamepadColtroller.updateRockerButtons(e)},setGamepadControll(e){this.gamepadColtroller=e},initGamepadControll(){!this.gamepadColtroller||(this.gamepadColtroller.onlyRockerButtons=!0,this.gamepadColtroller.setRockerButtons(!0,8),this.gamepadColtroller.set_R_RockerButtons(!0,8),this.gamepadColtroller.onStatusChange=()=>{this.L_RockerButtonsActivedStatus=[this.gamepadColtroller.status.Up,this.gamepadColtroller.status.Right,this.gamepadColtroller.status.Down,this.gamepadColtroller.status.Left],this.R_RockerButtonsActivedStatus=[this.gamepadColtroller.status.FN_Up,this.gamepadColtroller.status.FN_Right,this.gamepadColtroller.status.FN_Down,this.gamepadColtroller.status.FN_Left]})}},mounted(){this.init()}});function Bo(e,t,s,n,i,o){const r=Vue.resolveComponent("GamepadButtonIcon"),u=Vue.resolveComponent("TouchControllerRocker");return Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{class:"TouchController",onTouchstart:t[2]||(t[2]=Vue.withModifiers(()=>{},["prevent"]))},[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.menuButtons,l=>(Vue.openBlock(),Vue.createBlock(r,{class:"TouchController-button","button-name":l.name,label:l.label,"data-actived":l.isDown,onTouchstart:Vue.withModifiers(w=>e.updateButtonStatus(l,!0),["stop","prevent"]),onTouchcancel:w=>e.updateButtonStatus(l,!1),onTouchend:w=>e.updateButtonStatus(l,!1)},null,8,["button-name","label","data-actived","onTouchstart","onTouchcancel","onTouchend"]))),256)),e.isTouchDevice?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:0},[Vue.createVNode(u,{class:"TouchController-L-Rocker",buttons:["Up","Right","Down","Left"],buttonsActivedStatus:e.L_RockerButtonsActivedStatus,"onUpdate:position":t[0]||(t[0]=l=>e.updateRockerStatus("L_Rocker",l))},null,8,["buttonsActivedStatus"]),Vue.createVNode(u,{class:"TouchController-R-Rocker",buttons:["FN_Up","FN_Right","FN_Down","FN_Left"],buttonsActivedStatus:e.R_RockerButtonsActivedStatus,"onUpdate:position":t[1]||(t[1]=l=>e.updateRockerStatus("R_Rocker",l))},null,8,["buttonsActivedStatus"])],64)):Vue.createCommentVNode("",!0)],544)),[[Vue.vShow,e.isTouchDevice]])}var Ro=N(Ao,[["render",Bo]]);const To=Vue.defineComponent({setup(){const e=document.createElement("canvas"),t=e.getContext("2d");return e.height=220,e.width=240,{store:L(),screenshotCanvas:e,screenshotCtx:t,touchController:Vue.ref(),GameScene:Vue.ref(),nes:null,recorder:null,videoChunks:null,audioStreamDestination:null,timeController:null}},components:{Menus:Do,TouchController:Ro},data(){return{selectSavedDataModel:!1,timeControllerModel:!1,timeFasterModel:!1,lastSlowedTime:0,lastSlowedTimeSpeed:1,timeSpeed:1,timeControllerStatus:"",timeControllerStatusViewShowing:!1,frameCount:"",importedReplayDatas:null}},computed:{__timeSpeed(){if(this.timeSpeed<1)switch(this.timeSpeed){case .5:return"1/2";case .25:return"1/4";case .125:return"1/8"}return this.timeSpeed}},watch:{"store.selectedGame"(){this.init()},"store.showMenu"(){!this.nes||(this.store.showMenu?(this.nes.pause(),this.timeController.pause()):(this.nes.resume(),this.timeController.resume()))},"store.gameConfig"(){this.initGameConfig()},timeSpeed(){this.updateTimeControllerStatusAnimeName()},timeControllerStatus(){this.updateTimeControllerStatusAnimeName()}},methods:{async updateTimeControllerStatusAnimeName(){this.timeControllerStatusViewShowing=!1,setTimeout(()=>{this.timeControllerStatusViewShowing=!0},1)},async importScript(e=null){const t=e||await Ot(".NESscript"),s=new Uint8Array(await t.arrayBuffer()),n=s.slice(0,16),i=s.slice(16),o=Array.from(n).map(l=>l.toString(16).padStart(2,"0")).join(""),u=this.store.views.Games.list.find(l=>l.md5==o);if(!u){this.store.alert("\u6CA1\u6709\u627E\u5230\u8BE5\u811A\u672C\u5BF9\u5E94\u7684\u6E38\u620F...");return}this.importedReplayDatas=Array.from(i).map(l=>l.toString(2).padStart(8,"0").split("")),u==this.store.selectedGame?this.loadGame(!0):this.store.playGame(u)},exportScript(){const e=Uint8Array.from(this.nes.replayDatas.map(n=>parseInt(n.join(""),2))),t=this.store.selectedGame.md5,s=new Uint8Array(16);for(let n=0;n<t.length;n+=2)s[n/2]=parseInt(t[n]+t[n+1],16);_n(new File([s,e],"test.NESscript"))},openAduio(){this.nes.openAduio()},async screenshot(){this.screenshotCtx.drawImage(this.nes.canvasElement,8,10,240,220,0,0,240,220);const e=this.screenshotCanvas.toDataURL("image/png");if(!this.store.selectedGame.preview)this.store.selectedGame.preview=e,this.store.saveGameList();else{await this.store.confirm("\u5DF2\u5B8C\u6210\u622A\u56FE , \u662F\u5426\u4E0B\u8F7D\u622A\u56FE\u6587\u4EF6 ?");const t=document.createElement("a");t.href=e,t.download=this.store.selectedGame.name+".png",t.click()}},saveData(){console.log("save"),this.nes.save()},loadData(e=0){console.log("load : ",e),this.nes.load(e)},timeContinue(){this.nes.timeContinue()},timeForward(){this.nes.timeControllerStatus="forward"},timeBack(){this.nes.timeControllerStatus="back"},setTimeSpeed(e=1){this.timeSpeed=Nt(e,.125,8),this.nes.setPlaySpeed(this.timeSpeed)},async testTas(){this.nes.initTasScript(await(await fetch("./nes/enola.fm2")).text()),this.loadGame(!0)},async loadGame(e=!1){this.importedReplayDatas&&(this.nes.replayDatas=this.importedReplayDatas,this.importedReplayDatas=null,e=!0),this.timeControllerModel=!1,this.timeControllerStatus="";try{this.nes.loadGame(this.store.selectedGame.romData,e,this.store.selectedGame.md5)}catch(t){t.message.includes("This ROM uses a mapper not supported by JSNES")||t.message.includes("Not a valid NES ROM")?(this.store.showMenu=!0,this.store.selectedGame.canPlay=!1,this.store.saveGameList(),this.store.alert(`( ${this.store.selectedGame.name} ) \u8FD9\u4E2A\u6E38\u620F\u4E0D\u80FD\u52A0\u8F7D , \u8BF7\u5C3D\u91CF\u4F7F\u7528\u539F\u7248\u6E38\u620F , \u6216\u8005\u4F7F\u7528\u5176\u4ED6\u6A21\u62DF\u5668\u6765\u73A9 !`)):alert(t.message)}},stopRecordVideo(){this.recorder.stop(),this.nes.script_processor.disconnect(this.audioStreamDestination)},startRecordVideo(){if(this.recorder)return;this.videoChunks=[];const e=this.nes.canvasElement.captureStream(60);this.audioStreamDestination=this.nes.audioContent.createMediaStreamDestination(),this.nes.script_processor.connect(this.audioStreamDestination),e.addTrack(this.audioStreamDestination.stream.getAudioTracks()[0]),this.recorder=new MediaRecorder(e,{audioBitsPerSecond:128*1e3,videoBitsPerSecond:1e3*1024,mimeType:"video/webm;codecs=h264"}),this.recorder.ondataavailable=t=>{this.videoChunks.push(t.data)},this.recorder.start(),this.recorder.onstop=t=>{const s=new File(this.videoChunks,"video.webm"),n=URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download="video.webm",i.click(),this.videoChunks=null}},initGameConfig(){this.nes.gameController.gamepadController.setRockerButtons(this.store.gameConfig.useRockerButtons,this.store.gameConfig.useRockerButtonsType)},initNESPlayer(){this.nes=new yn,this.nes.initGameController(this.store.gameControllerBindDatas.gameing.gamepad,this.store.gameControllerBindDatas.gameing.keyboard),this.nes.onCanvasUpdate=e=>{this.frameCount=`${e} / ${this.nes.replayDatas.length}`,this.timeControllerStatus=this.nes.timeControllerStatus},this.touchController.setGamepadControll(this.nes.gameController.gamepadController)},updateCanvasElementSize(){const e=this.GameScene.offsetWidth,t=this.GameScene.offsetHeight;e/t>256/240?this.nes.canvasElement.style.cssText="height:100%":this.nes.canvasElement.style.cssText="width:100%"},initCanvasElement(){this.GameScene.appendChild(this.nes.canvasElement),this.updateCanvasElementSize(),window.addEventListener("resize",this.updateCanvasElementSize)},async init(){await this.nes.initSavedData(this.store.selectedGame.md5),this.loadGame(),this.nes.resume()},timeFaster(){console.log(this.timeFasterModel),this.timeFasterModel=!0,this.timeSpeed<1?this.setTimeSpeed(2):this.setTimeSpeed(this.timeSpeed*2)},timeSlows(){if(Date.now()-this.lastSlowedTime<300){this.setTimeSpeed(this.lastSlowedTimeSpeed/2),this.lastSlowedTimeSpeed=this.timeSpeed,this.lastSlowedTime=Date.now();return}this.timeSpeed<1?this.setTimeSpeed(1):(this.setTimeSpeed(this.timeSpeed/2),this.lastSlowedTimeSpeed=this.timeSpeed),this.lastSlowedTime=Date.now()},enterTimeControllerModel(){this.timeControllerModel=!0,this.timeControllerStatus="paused",this.nes.pause()},exitTimeControllerModel(){this.timeControllerModel=!1,this.timeControllerStatus="",this.timeSpeed>1&&this.setTimeSpeed(1),this.timeContinue(),this.nes.resume()},timeControllerModel_forward(){this.timeControllerStatus=="back"?this.timeSpeed>1?this.setTimeSpeed(this.timeSpeed/2):(this.timeControllerStatus="paused",this.nes.pause()):this.timeControllerStatus=="paused"?(this.timeControllerStatus="forward",this.timeForward(),this.nes.resume()):this.timeControllerStatus=="forward"&&this.setTimeSpeed(this.timeSpeed*2)},timeControllerModel_back(){this.timeControllerStatus=="forward"?this.timeSpeed>1?this.setTimeSpeed(this.timeSpeed/2):(this.timeControllerStatus="paused",this.nes.pause()):this.timeControllerStatus=="paused"?(this.timeControllerStatus="back",this.timeBack(),this.nes.resume()):this.timeControllerStatus=="back"&&this.setTimeSpeed(this.timeSpeed*2)},showSavedDatas(){},onControllerButtonDown(e){if(!this.selectSavedDataModel){if(this.timeControllerModel==!1){switch(e){case"Time":this.timeController.status.Slow?this.timeFaster():this.enterTimeControllerModel();break;case"Slow":this.timeSlows();break;case"Save":this.saveData();break}return}switch(e){case"Time":this.exitTimeControllerModel();break;case"Slow":case"Down":this.setTimeSpeed(this.timeSpeed/2);break;case"Save":case"Left":this.timeControllerModel_back();break;case"Load":case"Right":this.timeControllerModel_forward();break}}},onControllerButtonHold(e){switch(e){case"Load":this.timeControllerModel==!1&&(console.log("select loadData"),this.selectSavedDataModel=!0,this.nes.resume());break;case"Time":this.timeFasterModel==!1&&(this.timeControllerStatus="back",this.timeBack(),this.nes.resume());break}},onControllerButtonUp(e,t){if(e=="Slow"&&this.timeFasterModel==!0){this.timeFasterModel=!1,this.setTimeSpeed(1);return}if(t){switch(e){case"Time":this.timeFasterModel==!1&&this.exitTimeControllerModel();break}return}switch(e){case"Load":this.timeFasterModel==!1&&this.loadData();break}},initGameController(){this.timeController=new j("time",Cn),this.timeController.bindGamepad(this.store.gameControllerBindDatas.time.gamepad),this.timeController.bindKeyBoard(this.store.gameControllerBindDatas.time.keyboard),this.timeController.initGamePad(),this.timeController.initKeyboard(),this.timeController.setHoldButtons(["Time","Load"]),this.timeController.onButtonDown=this.onControllerButtonDown,this.timeController.onButtonHold=this.onControllerButtonHold,this.timeController.onButtonUp=this.onControllerButtonUp},touchControllerUpdate({name:e,isDown:t}){e=="Home"&&t==!0&&(this.store.showMenu=!0),this.timeController.gamepadController.updateStatus(e,t)}},beforeUnmount(){this.nes.destroy(),window.removeEventListener("resize",this.updateCanvasElementSize)},async mounted(){this.initNESPlayer(),this.initGameConfig(),this.initCanvasElement(),this.initGameController(),this.nes.pause(),window.app=this}}),No={ref:"GameScene",class:"GameScene"},Oo=["data-status"],$o={key:0,class:"paused",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1376",width:"200",height:"200"},Lo=Vue.createElementVNode("path",{d:"M819.2 0c84.832 0 153.6 63.68 153.6 142.2336v739.5328C972.8 960.32 904.032 1024 819.2 1024s-153.6-63.68-153.6-142.2336V142.2336C665.6 63.68 734.368 0 819.2 0zM204.8 0c84.832 0 153.6 63.68 153.6 142.2336v739.5328C358.4 960.32 289.632 1024 204.8 1024s-153.6-63.68-153.6-142.2336V142.2336C51.2 63.68 119.968 0 204.8 0z","p-id":"1377"},null,-1),bo=[Lo],Io={key:1,class:"playing",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1521",width:"200",height:"200"},xo=Vue.createElementVNode("path",{d:"M852.2496 392.448c104.6848 66.0288 104.6272 173.1136 0 239.104l-573.1008 361.472C174.464 1059.04 89.6 1016.0448 89.6 897.1328V126.8608C89.6 7.8848 174.5216-35.0144 279.1488 30.976l573.1008 361.472z","p-id":"1522"},null,-1),Mo=[xo],Uo={key:2,class:"back",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1664",width:"200",height:"200"},Po=Vue.createElementVNode("path",{d:"M8.815579 483.543943c-0.665592 1.369584-1.836779 2.559971-2.335973 3.846356-12.044661 24.767715-6.96952 54.668171 12.531055 73.835951l460.481105 445.24288a61.631291 61.631291 0 0 0 88.510982-2.483172c23.762927-25.676505 22.681339-66.194439-2.431972-90.494959l-413.345647-399.611405L563.900395 108.469857c24.063723-25.324509 23.48773-65.791243-1.279985-90.392561a61.503293 61.503293 0 0 0-85.298219-1.72798L21.020238 465.854547c-0.755191 0.85759-1.087987 2.220774-2.092776 3.071964-0.582393 0.691192-1.254386 1.113587-2.086376 1.79838-3.763157 3.846356-5.516737 8.550302-7.935908 12.819052h-0.089599z","p-id":"1665"},null,-1),Ho=Vue.createElementVNode("path",{d:"M447.671332 483.543943c-0.671992 1.369584-1.843179 2.559971-2.342373 3.846356-12.038262 24.767715-6.96312 54.668171 12.537456 73.835951l460.474704 445.24288a61.631291 61.631291 0 0 0 88.510982-2.483172c23.769327-25.676505 22.681339-66.194439-2.431972-90.494959l-413.339246-399.611405 411.675265-405.409737c24.057323-25.324509 23.48773-65.791243-1.279985-90.392561a61.503293 61.503293 0 0 0-85.304619-1.72798L459.869592 465.854547c-0.748791 0.85759-1.087987 2.220774-2.086376 3.071964-0.588793 0.691192-1.254386 1.113587-2.092776 1.79838-3.756757 3.846356-5.516737 8.550302-7.935909 12.819052h-0.083199z","p-id":"1666"},null,-1),Go=[Po,Ho],jo={key:3,class:"forward",style:{transform:"scale(-1,1)"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1664",width:"200",height:"200"},zo=Vue.createElementVNode("path",{d:"M8.815579 483.543943c-0.665592 1.369584-1.836779 2.559971-2.335973 3.846356-12.044661 24.767715-6.96952 54.668171 12.531055 73.835951l460.481105 445.24288a61.631291 61.631291 0 0 0 88.510982-2.483172c23.762927-25.676505 22.681339-66.194439-2.431972-90.494959l-413.345647-399.611405L563.900395 108.469857c24.063723-25.324509 23.48773-65.791243-1.279985-90.392561a61.503293 61.503293 0 0 0-85.298219-1.72798L21.020238 465.854547c-0.755191 0.85759-1.087987 2.220774-2.092776 3.071964-0.582393 0.691192-1.254386 1.113587-2.086376 1.79838-3.763157 3.846356-5.516737 8.550302-7.935908 12.819052h-0.089599z","p-id":"1665"},null,-1),qo=Vue.createElementVNode("path",{d:"M447.671332 483.543943c-0.671992 1.369584-1.843179 2.559971-2.342373 3.846356-12.038262 24.767715-6.96312 54.668171 12.537456 73.835951l460.474704 445.24288a61.631291 61.631291 0 0 0 88.510982-2.483172c23.769327-25.676505 22.681339-66.194439-2.431972-90.494959l-413.339246-399.611405 411.675265-405.409737c24.057323-25.324509 23.48773-65.791243-1.279985-90.392561a61.503293 61.503293 0 0 0-85.304619-1.72798L459.869592 465.854547c-0.748791 0.85759-1.087987 2.220774-2.086376 3.071964-0.588793 0.691192-1.254386 1.113587-2.092776 1.79838-3.756757 3.846356-5.516737 8.550302-7.935909 12.819052h-0.083199z","p-id":"1666"},null,-1),Jo=[zo,qo],Wo=Vue.createElementVNode("div",{class:"SavedDataView"},[Vue.createElementVNode("div",{class:"SavedData"},[Vue.createElementVNode("img",{src:""}),Vue.createElementVNode("span"),Vue.createElementVNode("span")])],-1),Xo={class:"testFunctions"},Yo=Vue.createElementVNode("br",null,null,-1),Zo=Vue.createElementVNode("br",null,null,-1),Qo={class:"testFunctions-status"};function Ko(e,t,s,n,i,o){const r=Vue.resolveComponent("TouchController"),u=Vue.resolveComponent("Menus");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[Vue.createElementVNode("div",No,null,512),e.timeControllerStatusViewShowing?(Vue.openBlock(),Vue.createElementBlock("div",{key:0,class:"TimeControllerStatus flex acenter","data-status":e.timeControllerStatus},[e.timeControllerStatus=="paused"?(Vue.openBlock(),Vue.createElementBlock("svg",$o,bo)):e.timeControllerStatus==""?(Vue.openBlock(),Vue.createElementBlock("svg",Io,Mo)):e.timeControllerStatus=="back"?(Vue.openBlock(),Vue.createElementBlock("svg",Uo,Go)):e.timeControllerStatus=="forward"?(Vue.openBlock(),Vue.createElementBlock("svg",jo,Jo)):Vue.createCommentVNode("",!0),Vue.createElementVNode("span",null,Vue.toDisplayString(e.__timeSpeed),1)],8,Oo)):Vue.createCommentVNode("",!0),Wo,Vue.createElementVNode("div",Xo,[Vue.createElementVNode("button",{onClick:t[0]||(t[0]=(...l)=>e.openAduio&&e.openAduio(...l))},"\u6253\u5F00\u58F0\u97F3"),Vue.createElementVNode("button",{onClick:t[1]||(t[1]=l=>e.loadGame())},"\u5F00\u59CB"),Vue.createElementVNode("button",{onClick:t[2]||(t[2]=l=>e.loadGame(!0))},"\u5F00\u59CB\u64AD\u653E"),Vue.createElementVNode("button",{onClick:t[3]||(t[3]=(...l)=>e.testTas&&e.testTas(...l))},"Tas\u811A\u672C\u64AD\u653E"),Vue.createElementVNode("button",{onClick:t[4]||(t[4]=(...l)=>e.startRecordVideo&&e.startRecordVideo(...l))},"\u5F55\u5236\u89C6\u9891"),Vue.createElementVNode("button",{onClick:t[5]||(t[5]=(...l)=>e.stopRecordVideo&&e.stopRecordVideo(...l))},"\u5F55\u5236\u7ED3\u675F"),Yo,Vue.createElementVNode("button",{onClick:t[6]||(t[6]=(...l)=>e.exportScript&&e.exportScript(...l))},"\u5BFC\u51FA\u811A\u672C"),Vue.createElementVNode("button",{onClick:t[7]||(t[7]=l=>e.importScript())},"\u5BFC\u5165\u811A\u672C"),Vue.createElementVNode("button",{onClick:t[8]||(t[8]=l=>e.saveData())},"\u5B58\u6863"),Vue.createElementVNode("button",{onClick:t[9]||(t[9]=l=>e.loadData())},"\u8BFB\u6863"),Vue.createElementVNode("button",{onClick:t[10]||(t[10]=l=>e.timeBack())},"\u65F6\u95F4\u5012\u6D41"),Vue.createElementVNode("button",{onClick:t[11]||(t[11]=l=>e.timeForward())},"\u65F6\u95F4\u524D\u8FDB"),Vue.createElementVNode("button",{onClick:t[12]||(t[12]=l=>e.setTimeSpeed(e.timeSpeed*2))},"\u52A0\u901F"),Vue.createElementVNode("button",{onClick:t[13]||(t[13]=l=>e.setTimeSpeed(e.timeSpeed/2))},"\u51CF\u901F"),Zo,Vue.createElementVNode("div",Qo,[Vue.createElementVNode("div",null,"\u5E27 : "+Vue.toDisplayString(e.frameCount),1),Vue.createElementVNode("div",null,"\u72B6\u6001 : "+Vue.toDisplayString(e.timeControllerStatus),1)])]),Vue.createVNode(r,{ref:"touchController","onUpdate:button":e.touchControllerUpdate},null,8,["onUpdate:button"]),Vue.createVNode(u,{onScreenshot:e.screenshot},null,8,["onScreenshot"])],64)}var er=N(To,[["render",Ko]]);const tr=Vue.defineComponent({name:"App",setup(e){return(t,s)=>(Vue.openBlock(),Vue.createBlock(er))}});Vue.createApp(tr).use(Gt()).mount("#app");
